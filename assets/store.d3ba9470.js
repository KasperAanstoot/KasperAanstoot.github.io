import{_ as C,ab as Cn,ac as ee,ad as Ee,ae as li,af as qt,ag as fi,ah as Xe,ai as At,aj as hi,ak as di,al as It,am as Er,an as Bt,ao as pi,ap as mi,aq as vi,ar as An,as as yi,at as gi,au as z,av as Lt,aw as bi,ax as _i,ay as M,az as Sr,aA as In,aB as wi,aC as ki,aD as Bn,aE as xi,aF as Ei,aG as Si,aH as Rn,aI as Ci,aJ as Yn,aK as qe,aL as Jn,aM as Ai,aN as He,aO as Xn,aP as Ii,aQ as Zn,aR as Bi,aS as er,aT as Ri,aU as Oi,aV as Di,aW as Pi,aX as Ki,aY as Ti,aZ as ji,a_ as Mi}from"./index.4c020b78.js";import{o as Fi,u as Li,Q as Ni,a as Vi,b as zi,d as On}from"./lang.de9509f9.js";import{u as Ui}from"./index.ca6b85f3.js";class _t{constructor(e){var n;if((n=e.$)!=null&&n.toChecksum){const r=e.$.toChecksum({returnData:!0});this.id=C.hash(r),this.data=r}else Object.assign(this,e)}toGraphQL(){return`
      type RepositoryObject implements Node @model {
        data: JSONObject
      }
    `}toJSON(){return this}}const tr=new WeakMap,nr=new WeakMap;class je extends Cn{constructor(e){super(),this.id=C.randomId(),this.date=new Date,Object.assign(this,e),this.objects&&(this.objects=new ee(C.sortBy(this.objects,"id"),{key:"id",owner:this,type:_t,unique:!0}),this._objectsByIdMap=C.keyBy(this.objects,"data.id")),this.checksum=this._createChecksum()}static fromJSON(e){return C.isString(e)&&(e=JSON.parse(e)),new je(e)}_createChecksum(){return C.hash(C.sortBy(this.objects,"id"))}_getObjectsByChecksumMap(){let e=nr.get(this);return e||(e={},nr.set(this,e)),e}_getObjectsByIdMap(){let e=tr.get(this);return e||(e={},tr.set(this,e)),e}amend(e){const n=this,r=[];return C.forEach(C.castArray(e),i=>{if(n.getObjectByChecksum(i))return;const o=n.getObjectById(i);o&&n.objects.remove(o),n.objects.add(i),r.push(i)}),r.length&&(this.checksum=this._createChecksum()),this}get(e){return this.getObjectByChecksum(e)||this.getObjectById(e)}getObjectByChecksum(e){return this.objects.get((e==null?void 0:e.id)||e)}getObjectById(e){var n;return(n=this._objectsByIdMap)==null?void 0:n[(e==null?void 0:e.id)||e]}getChanges(){return this.parent?{added:new ee,changed:new ee,removed:new ee}:{added:new ee}}getParent(e=1){return this.getParents(e)[e-1]}getParents(e=1/0){const n=[];let r=this.parent;for(;r&&n.length<e;)n.push(r),r=r.parent;return n}revert({change:e}){}toGraphQL(){return`
      type Commit implements Node {
        authorId: String @ownerId
        author: User @join @owner
        children: [Commit!] @derived # @flatMap(collection: "_parents", iteratee: "child")
        commitObjects: [CommitObject!]! @composition @join(fk: "CommitObject.commitId")
        date: DateTime! @createdAt
        name: String
        message: String
        objects: [CommittedObject!]! @delegates(to: ["commitObjects.object"])
        parentId: String
        # parent: Commit @join
        _parents: [CommitHierarchy!] @join(fk: "CommitHierarchy.parentId")
        # _parents: [CommitParents!] @composition @join(fk: "CommitParents.parentId")
        parents: [CommitParents!] @derived # @flatMap(list: "_parents", iteratee: "parent")
        repositoryId: String!
        repository: Repository!
      }

      type CommitHierarchy implements Node {
        childId: String
        child: Commit @join(fk: "childId")
        parentId: String
        parent: Commit @join(fk: "childId")
      }
    `}toJSON(){var e;return{__typename:"Repository.Commit",id:this.id,authorId:(e=this.author)==null?void 0:e.id,date:this.date,name:this.name,message:this.message,objects:this.objects,parents:C.map(this.parents,n=>({__typename:"ecore.EREf",eClass:"Repository.Commit",id:n.id}))}}}class rr extends Cn{constructor(e,n){super(),this.id=C.randomId(),this.name="main",this.commit=null,this.commitId=null,this.repository=null,this.repositoryId=null,Object.assign(this,e)}getHistory(){const e=this.commit.getParents();return[this.commit,...e]}toGraphQL(){return`
      interface Branch implements Node {
        description: String
        name: String
        # mergeOptions: JSONObject
        repositoryId: String!
        repository: Repository! @join(fk: "repositoryId")
      }

      type MainBranch implements Branch {
        commitId: String # Als die null is, dan is het main!
        commit: Commit # Als die null is, dan is het main!
        name: String @default(value: "main")
      }

      type DevergedBranch implements Branch {
        commitId: String!
        commit: Commit!
      }
    `}}class ir{constructor(e){this.id=C.randomId(),this.checksum=C.hash(JSON.stringify(this.toChecksum())),Object.assign(this,e)}toGraphQL(){return`
      type MergeConflict implements Node @model {
        checksum: Checksum!
        sourceObject: CommittedObject @join(fk: "sourceChecksum")
        sourceChecksum: Checksum!
        targetObject: CommittedObject! @join(fk: "targetChecksum")
        targetChecksum: Checksum!
      }
    `}toChecksum(){return{sourceChecksum:this.sourceChecksum,targetChecksum:this.targetChecksum}}toJSON(){return{id:this.id,sourceChecksum:this.sourceChecksum,targetChecksum:this.targetChecksum}}}class qi extends Cn{constructor(e){if(super(),!(e!=null&&e.name))throw new Ee("name");if(!(e!=null&&e.url))throw new Ee("url");Object.assign(this,e)}async fetch(e){}async pull(e){var o;let{branch:n="main"}=e;const r=(n==null?void 0:n.name)||n;if(n=this.branches[r],!n)throw new ValidationError(`Branch ${r} does not exist`);(((o=this.$)==null?void 0:o.container)||this.repository).merge(n)}async push(e){let{allBranches:n,branches:r,branch:i}=e;if(!C.isEmpty(this.branches)&&(r||(r=n?C.values(this.branches):[i||this.currentBranch]),!(!remotes&&(remotes=allRemotes?C.values(this.remotes):[remote||this.origin],!remotes[0]))))for(const o of remotes)for(const a of r);}toGraphQL(){return`
      type Remote {
        name: String!
        url: String!
      }
    `}}class or extends Error{constructor(e){super(e),this.name="MergeError"}}const ve=Symbol("stagingArea");class Hi extends li{constructor(e){super(e),this.id=C.randomId(),this.branches=new ee({key:"name",owner:this,type:rr}),this.currentBranch=null,this.commits=new ee({key:"id",owner:this,type:je}),this.head=null,this.main=this.createBranch({name:"main"}),this.checkout(this.main),this.objects=new ee({key:"id",owner:this,type:_t,unique:!0}),this.remotes=new ee({key:"name",owner:this,type:this.constructor}),this.schema=null,this._createStagingArea(),e!=null&&e.clone||C.isEmpty(e)||Object.assign(this,e),this.origin=null}static fromJSON(e){}_addObject(e){return this.objects.add(e),e}_createStagingArea(){this[ve]=new ee({key:"id",owner:this,type:_t,unique:!0})}_createObject(e){return new _t(e)}_getCommonAncestor(e){const n=C.map(e,i=>new ee(i.getHistory(),{key:"checksum"}));return C.intersectionBy(n,"checksum")}add(e,n){if(!e)return;const r=this;if(C.isArray(e))return C.map(e,a=>r.add(a,n));const i=this.head.commit,o=this.get(e.data.id);if(!(o&&o.$.removedAt&&!i.getObjectById(o.id))&&!(i!=null&&i.getObjectByChecksum(e)))return this[ve].add(e),e}addRemote(e){if(!e)throw Ee("data");if(this.remotes[e==null?void 0:e.name])throw new ValidationError(`A Remote with name '${e.name}' already exists. Use Remote.remove to remove. An .addRemote to re-create`);const r=new qi(e);return this.remotes.add(r),r}checkout(e){const n=this.branches.get((e==null?void 0:e.name)||e);if(n)return this._createStagingArea(),this.currentBranch=n,this.head=n,n;{const r=(e==null?void 0:e.name)||e;return this.createBranch({name:r},{checkout:!0})}}commit(e,n={}){var c;let{all:r,amend:i}=n;const o=(c=this.currentBranch)==null?void 0:c.commit;if(qt.isNode(e))i=!0,this.add(node);else if(e!=null&&e.objects)this[ve].add(e.objects);else{r=!0;const u=this.getChanges();C.forEach(u.added,l=>this[ve].add(l)),C.forEach(u.changed,l=>this[ve].add(l)),C.forEach(u.removed,l=>this[ve].add(l))}let a=this[ve];const s=C.keyBy(a,"data.id");if(C.isEmpty(a))return null;if(o&&i)return o.amend(a);{const u={...e,objects:[]};qt.isNode(e)||C.merge(u,e),!u.parents&&o&&(u.parents=[o]),C.forEach(u.parents,h=>{C.forEach(h.objects,f=>{s[f.data.id]||u.objects.push(f)})}),C.forEach(a,h=>{const f=this.get(h.data.id);f!=null&&f.$.removedAt||u.objects.push(h)});const l=new je(u);return C.forEach(l.objects,h=>{this.objects.add(h)}),this.commits.add(l),this.head.commit=l,this._createStagingArea(),l}}createBranch(e={},n={}){var a;let{checkout:r,commit:i}=n;if(!C.isEmpty(this.branches)){if(!e.name)throw new Ee("data.name");if(this.branches[e.name])throw new ValidationError(`A Branch with name '${e.name}' already exists. Use .checkout(branchName) to switch branches`);if(i||(i=((a=this.head)==null?void 0:a.commit)||this.head),!(i instanceof je))throw new ValidationError("head is not a commit");e={...e,commit:i}}const o=new rr(e);return o.repository=this,o.repositoryId=this.id,this.branches.add(o),r===!0?this.checkout(o):o}createNode(...e){const n=super.createNode.apply(this,e);return C.forEach(C.castArray(n),r=>{r.$.getRevisions=function(){var i;(i=this.store.head)==null||i.commit}}),n}deleteBranch(e,n){const r=(e==null?void 0:e.name)||e,i=this.branches.get(r);if(!i)throw new ValidationError(`A Branch with name '${r}' doest not exist`);if(i.name==="main")throw new ValidationError("You cannot remove the 'main' branch");if(this.currentBranch===i){let{checkout:o}=n||{};(!o||o===i.name)&&(o="main"),this.checkout(o)}return this.branches.remove(i)}async fetch(e){let{all:n,remote:r="origin"}=e;if(n)for(const i of this.remotes)await i.fetch(C.omit(e,["all","remote"]));else{if(!(e!=null&&e.remote))throw new Ee("remote");const i=(r==null?void 0:r.name)||r;if(r=this.remotes[i],!r)throw new ValidationError(`Remote ${i} does not exist`);return r.fetch(C.omit(e,["remote"]))}}getChanges(){const e=[],n=[],r=[],i=this.head.commit;C.forEach(this.nodes,a=>{let s=i==null?void 0:i.getObjectById(a.id);if(s){const c=a.$.toChecksum();(i==null?void 0:i.getObjectByChecksum(c))?r.push(s):n.push(this._createObject(a))}else a.$.createdAt&&(s=this._createObject(a),e.push(s))});const o=C.filter(i==null?void 0:i.objects,a=>!this.objects.get(a.id));return{added:e.length?e:null,changed:n.length?n:null,removed:o.length?o:null,unchanged:r.length?r:null}}getStagingArea(){return this[ve]}merge_OLD(e,n){if(C.isEmpty(e))throw new Ee("from");const r=this,{allowUnrelatedHistories:i=!1,fastForward:o=!0,noCommit:a=!1,into:s}=n;let c=this.branches.get((s==null?void 0:s.name)||s)||this.currentBranch;const u=C.map(C.castArray(e),d=>{const m=(d==null?void 0:d.name)||d,g=this.branches.get(m);if(!g)throw new or(`Branch with name '${m}' does not exists`);return g}),l=this._getCommonAncestor([c,...u]);function h({base:d,commit:m,source:g,target:w}){m||(m={objects:[],parents:[]});const y=[],p=[],_=[],b=[];return C.forEach(g.objects,k=>{const S=d.objects.getObjectById(k.id),x=w.objects.getObjectById(k.id);S?k.checksum===S.checksum?x?x.checksum===k.checksum?(b.push(S),m.objects.push(S)):(y.push(x),m.objects.push(x)):(b.push(S),m.objects.push(S)):x?x.checksum===S.checksum?(p.push(k),m.objects.push(k)):_.push({sourceObject:k,targetObject:x}):(p.push(k),m.objects.push(k)):m.objects.has(k)||m.objects.push(k)}),C.forEach(w.objects,k=>{const S=g.objects.getById(k.id);S?S.checksum===k.checksum?b.push(k):l.objects.getObjectByChecksum(k.checksum)||p.push(k):l.objects.getObjectById(k.id)||y.push(k)}),{commit:m,added:y,changed:p,conflicts:_,unchanged:b}}let f={objects:[],parents:[]},v={message:null,name:null,commit(d){return r.commit({...d,...f})}};return C.forEach(u,d=>{const m=this._getCommonAncestor([c,d]),{commit:g,added:w,changed:y,conflicts:p,unchanged:_}=h({base:m,commit:f,source:c.commit,target:d.commit});f=g,v.added=v.added?[...v.added,...w]:[...w],v.changed=v.changed?[...v.changed,...y]:[...y],v.conflicts=v.conflicts?[...v.conflicts,...p]:[...p],v.unchanged=v.unchanged?[...v.unchanged,..._]:[..._]}),v}merge(e,n){if(C.isEmpty(e))throw new Ee("from");const r=this,{allowUnrelatedHistories:i=!1,fastForward:o=!0,noCommit:a=!1,into:s}=n;let c=this.branches.get((s==null?void 0:s.name)||s)||this.currentBranch;const u=C.map(C.castArray(e),v=>{const d=(v==null?void 0:v.name)||v,m=this.branches.get(d);if(!m)throw new or(`Branch with name '${d}' does not exists`);return m});let l={objects:[...c.commit.objects],parents:[]},h={added:[],conflicts:[],message:null,name:null,commit(v){return r.commit({...v,...l})}};function f({base:v,source:d,target:m}){const g=[],w=new ee({key:"checksum",type:ir,unique:!0}),y=[];return C.forEach(m.objects,p=>{const _=d.objects.getById(p.id);_?p.checksum===_.checksum?y.push(p):w.push(new ir({sourceObject:_,targetObject:p})):(g.push(p),l.objects.push(p))}),{added:g,conflicts:w,unchanged:y}}if(C.forEach(u,v=>{const d=this._getCommonAncestor([c,v]);if(d)if(source.commit===d&&n.fastForward)c.commit=v.commit;else{const{added:m,conflicts:g,unchanged:w}=f({base:d,source:c.commit,target:v.commit});h.added=[...h.added,...m],h.conflicts=[...h.conflicts,...g],l.parents.push(v.commit)}else n.allowUnrelatedHistories&&(l.objects=[...l.objects,...v.commit.objects],h.added=h.added?[...h.added,...v.commit.objects]:[...v.commit.objects],l.parents.push(v.commit))}),C.isEmpty(h.conflicts)){if(n.noCommit)return h;{const v=new je(l);c.commit=v}}else return h}async pull(e){let{remote:n="origin"}=e;const r=(n==null?void 0:n.name)||n;if(n=this.remotes[r],!n)throw new ValidationError(`Remote ${r} does not exist`);return n.pull(e)}async push(e){let{remote:n="origin"}=e;const r=(n==null?void 0:n.name)||n;if(n=this.remotes[r],!n)throw new ValidationError(`Remote ${r} does not exist`);return n.push(e)}remove(...e){const n=super.remove.apply(this,e),r=C.keyBy(C.castArray(n),"id");this.objects.remove(i=>r[i.data.id])}restore(){delete this.$.removedAt}setOrigin(e){const n=(e==null?void 0:e.name)||e;if(e=this.remotes[n],!e)throw ValidationError(`A Remote with name '${n}' does not exist. Use .addRemote to add a Remote`);this.origin=e}toGraphQL(){return`
      scalar Checksum

      type RepositoryNode implements Node {
        authorId: String @ownerId
        author: User @owner
        # repositoryId: String!
        # repository: Repository!
      }

      type Repository implements RepositoryNode @model {
        # date: DateTime! @createdAt
        branches: [Branch!] @composition @join(fk: "Branch.repositoryId")
        commits: [Commit!] @composition @join(fk: "Commit.repositoryId")
        headId: String
        head: Branch @composition @join(fk: "headId")
        # head: Branch @resolve(body: "return parent.branches?.find(o => o.name === 'main')", deps: ["branches"])
        name: String
        # originId: String
        # origin: Remote @composition @join(fk: "originId")
        # origin: Remote @resolve(body: "return parent.remotes?.find(o => o.name === 'origin')", deps: ["remotes"])
        remotes: [RepositoryRemote] @composition @join(fk: "RepositoryRemote.repositoryId") # @flatMap(in: "o", iteratee: "remote")
        # remotes: [Remote] @composition @join(fk: "RepositoryRemote.repositoryId") # @flatMap(in: "o", iteratee: "remote")
        schema: JSONObject @derived # Ophalen o.b.v. this.url
        url: URL # NB: Kan zijn http(s)://${host}:${port}/graphql?query=query+getSchema&auth=..."
      }

      # type Remote implements RepositoryNode {
        type RepositoryRemote implements Node {
        remotedId: String!
        remote: Repository
        repositoryId: String!
        repository: Repository
      }
    `}upsert(e,n){if(n||(n=this.nodes[e.id]),n){if(e instanceof qt)return e===n||n.merge(e),n;n.merge(e)}else return this.createNode(e)}}/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let Cr;const Dn=t=>Cr=t,$i=Symbol();function Zt(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var We;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(We||(We={}));const Ar=()=>{};function ar(t,e,n,r=Ar){t.push(e);const i=()=>{const o=t.indexOf(e);o>-1&&(t.splice(o,1),r())};return!n&&mi()&&vi(i),i}function De(t,...e){t.slice().forEach(n=>{n(...e)})}const Qi=t=>t();function en(t,e){t instanceof Map&&e instanceof Map&&e.forEach((n,r)=>t.set(r,n)),t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n],i=t[n];Zt(i)&&Zt(r)&&t.hasOwnProperty(n)&&!It(r)&&!Er(r)?t[n]=en(i,r):t[n]=r}return t}const Wi=Symbol();function Gi(t){return!Zt(t)||!t.hasOwnProperty(Wi)}const{assign:ye}=Object;function Yi(t){return!!(It(t)&&t.effect)}function Ji(t,e,n,r){const{state:i,actions:o,getters:a}=e,s=n.state.value[t];let c;function u(){s||(n.state.value[t]=i?i():{});const l=yi(n.state.value[t]);return ye(l,o,Object.keys(a||{}).reduce((h,f)=>(h[f]=gi(z(()=>{Dn(n);const v=n._s.get(t);return a[f].call(v,v)})),h),{}))}return c=Ir(t,u,e,n,r,!0),c}function Ir(t,e,n={},r,i,o){let a;const s=ye({actions:{}},n),c={deep:!0};let u,l,h=[],f=[],v;const d=r.state.value[t];!o&&!d&&(r.state.value[t]={}),Xe({});let m;function g(x){let E;u=l=!1,typeof x=="function"?(x(r.state.value[t]),E={type:We.patchFunction,storeId:t,events:v}):(en(r.state.value[t],x),E={type:We.patchObject,payload:x,storeId:t,events:v});const I=m=Symbol();An().then(()=>{m===I&&(u=!0)}),l=!0,De(h,E,r.state.value[t])}const w=o?function(){const{state:E}=n,I=E?E():{};this.$patch(D=>{ye(D,I)})}:Ar;function y(){a.stop(),h=[],f=[],r._s.delete(t)}function p(x,E){return function(){Dn(r);const I=Array.from(arguments),D=[],K=[];function j(L){D.push(L)}function P(L){K.push(L)}De(f,{args:I,name:x,store:b,after:j,onError:P});let R;try{R=E.apply(this&&this.$id===t?this:b,I)}catch(L){throw De(K,L),L}return R instanceof Promise?R.then(L=>(De(D,L),L)).catch(L=>(De(K,L),Promise.reject(L))):(De(D,R),R)}}const _={_p:r,$id:t,$onAction:ar.bind(null,f),$patch:g,$reset:w,$subscribe(x,E={}){const I=ar(h,x,E.detached,()=>D()),D=a.run(()=>At(()=>r.state.value[t],K=>{(E.flush==="sync"?l:u)&&x({storeId:t,type:We.direct,events:v},K)},ye({},c,E)));return I},$dispose:y},b=hi(_);r._s.set(t,b);const S=(r._a&&r._a.runWithContext||Qi)(()=>r._e.run(()=>(a=di()).run(e)));for(const x in S){const E=S[x];if(It(E)&&!Yi(E)||Er(E))o||(d&&Gi(E)&&(It(E)?E.value=d[x]:en(E,d[x])),r.state.value[t][x]=E);else if(typeof E=="function"){const I=p(x,E);S[x]=I,s.actions[x]=E}}return ye(b,S),ye(Bt(b),S),Object.defineProperty(b,"$state",{get:()=>r.state.value[t],set:x=>{g(E=>{ye(E,x)})}}),r._p.forEach(x=>{ye(b,a.run(()=>x({store:b,app:r._a,pinia:r,options:s})))}),d&&o&&n.hydrate&&n.hydrate(b.$state,d),u=!0,l=!0,b}function Xi(t,e,n){let r,i;const o=typeof e=="function";typeof t=="string"?(r=t,i=o?n:e):(i=t,r=t.id);function a(s,c){const u=pi();return s=s||(u?fi($i,null):null),s&&Dn(s),s=Cr,s._s.has(r)||(o?Ir(r,e,i,s):Ji(r,i,s)),s._s.get(r)}return a.$id=r,a}function sr(t){setTimeout(()=>{window.URL.revokeObjectURL(t.href)},1e4),t.remove()}function Zi(t,e,n={}){const{mimeType:r,byteOrderMark:i,encoding:o}=typeof n=="string"?{mimeType:n}:n,a=o!==void 0?new TextEncoder(o).encode([e]):e,s=i!==void 0?[i,a]:[a],c=new Blob(s,{type:r||"application/octet-stream"}),u=document.createElement("a");u.href=window.URL.createObjectURL(c),u.setAttribute("download",t),typeof u.download=="undefined"&&u.setAttribute("target","_blank"),u.classList.add("hidden"),u.style.position="fixed",document.body.appendChild(u);try{return u.click(),sr(u),!0}catch(l){return sr(u),l}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var T=function(){return T=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},T.apply(this,arguments)};function tn(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var N=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,U=Object.keys,$=Array.isArray;typeof Promise!="undefined"&&!N.Promise&&(N.Promise=Promise);function G(t,e){return typeof e!="object"||U(e).forEach(function(n){t[n]=e[n]}),t}var Ze=Object.getPrototypeOf,eo={}.hasOwnProperty;function X(t,e){return eo.call(t,e)}function Fe(t,e){typeof e=="function"&&(e=e(Ze(t))),(typeof Reflect=="undefined"?U:Reflect.ownKeys)(e).forEach(function(n){he(t,n,e[n])})}var Br=Object.defineProperty;function he(t,e,n,r){Br(t,e,G(n&&X(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Le(t){return{from:function(e){return t.prototype=Object.create(e.prototype),he(t.prototype,"constructor",t),{extend:Fe.bind(null,t.prototype)}}}}var to=Object.getOwnPropertyDescriptor;function Pn(t,e){var n=to(t,e),r;return n||(r=Ze(t))&&Pn(r,e)}var no=[].slice;function Nt(t,e,n){return no.call(t,e,n)}function Rr(t,e){return e(t)}function $e(t){if(!t)throw new Error("Assertion Failed")}function Or(t){N.setImmediate?setImmediate(t):setTimeout(t,0)}function Dr(t,e){return t.reduce(function(n,r,i){var o=e(r,i);return o&&(n[o[0]]=o[1]),n},{})}function ro(t,e,n){try{t.apply(null,n)}catch(r){e&&e(r)}}function fe(t,e){if(typeof e=="string"&&X(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,i=e.length;r<i;++r){var o=fe(t,e[r]);n.push(o)}return n}var a=e.indexOf(".");if(a!==-1){var s=t[e.substr(0,a)];return s===void 0?void 0:fe(s,e.substr(a+1))}}function ne(t,e,n){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){$e(typeof n!="string"&&"length"in n);for(var r=0,i=e.length;r<i;++r)ne(t,e[r],n[r])}else{var o=e.indexOf(".");if(o!==-1){var a=e.substr(0,o),s=e.substr(o+1);if(s==="")n===void 0?$(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=n;else{var c=t[a];(!c||!X(t,a))&&(c=t[a]={}),ne(c,s,n)}}else n===void 0?$(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function io(t,e){typeof e=="string"?ne(t,e,void 0):"length"in e&&[].map.call(e,function(n){ne(t,n,void 0)})}function Pr(t){var e={};for(var n in t)X(t,n)&&(e[n]=t[n]);return e}var oo=[].concat;function Kr(t){return oo.apply([],t)}var Tr="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Kr([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return N[t]}),ao=Tr.map(function(t){return N[t]});Dr(Tr,function(t){return[t,!0]});var be=null;function at(t){be=typeof WeakMap!="undefined"&&new WeakMap;var e=nn(t);return be=null,e}function nn(t){if(!t||typeof t!="object")return t;var e=be&&be.get(t);if(e)return e;if($(t)){e=[],be&&be.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(nn(t[n]))}else if(ao.indexOf(t.constructor)>=0)e=t;else{var i=Ze(t);e=i===Object.prototype?{}:Object.create(i),be&&be.set(t,e);for(var o in t)X(t,o)&&(e[o]=nn(t[o]))}return e}var so={}.toString;function rn(t){return so.call(t).slice(8,-1)}var on=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",uo=typeof on=="symbol"?function(t){var e;return t!=null&&(e=t[on])&&e.apply(t)}:function(){return null},Te={};function ce(t){var e,n,r,i;if(arguments.length===1){if($(t))return t.slice();if(this===Te&&typeof t=="string")return[t];if(i=uo(t)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var Kn=typeof Symbol!="undefined"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ae=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function jr(t,e){ae=t,Mr=e}var Mr=function(){return!0},co=!new Error("").stack;function Oe(){if(co)try{throw Oe.arguments,new Error}catch(t){return t}return new Error}function an(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(Mr).map(function(r){return`
`+r}).join("")):""}var lo=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Fr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Tn=lo.concat(Fr),fo={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ne(t,e){this._e=Oe(),this.name=t,this.message=e}Le(Ne).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+an(this._e,2))}},toString:function(){return this.name+": "+this.message}});function Lr(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function Rt(t,e,n,r){this._e=Oe(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Lr(t,e)}Le(Rt).from(Ne);function Ge(t,e){this._e=Oe(),this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=Lr(t,e)}Le(Ge).from(Ne);var jn=Tn.reduce(function(t,e){return t[e]=e+"Error",t},{}),ho=Ne,O=Tn.reduce(function(t,e){var n=e+"Error";function r(i,o){this._e=Oe(),this.name=n,i?typeof i=="string"?(this.message=""+i+(o?`
 `+o:""),this.inner=o||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=fo[e]||n,this.inner=null)}return Le(r).from(ho),t[e]=r,t},{});O.Syntax=SyntaxError;O.Type=TypeError;O.Range=RangeError;var ur=Fr.reduce(function(t,e){return t[e+"Error"]=O[e],t},{});function po(t,e){if(!t||t instanceof Ne||t instanceof TypeError||t instanceof SyntaxError||!t.name||!ur[t.name])return t;var n=new ur[t.name](e||t.message,t);return"stack"in t&&he(n,"stack",{get:function(){return this.inner.stack}}),n}var Vt=Tn.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=O[e]),t},{});Vt.ModifyError=Rt;Vt.DexieError=Ne;Vt.BulkError=Ge;function F(){}function st(t){return t}function mo(t,e){return t==null||t===st?e:function(n){return e(t(n))}}function Be(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function vo(t,e){return t===F?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Be(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Be(i,this.onerror):i),o!==void 0?o:n}}function yo(t,e){return t===F?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Be(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Be(r,this.onerror):r)}}function go(t,e){return t===F?e:function(n){var r=t.apply(this,arguments);G(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Be(i,this.onsuccess):i),o&&(this.onerror=this.onerror?Be(o,this.onerror):o),r===void 0?a===void 0?void 0:a:G(r,a)}}function bo(t,e){return t===F?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function Mn(t,e){return t===F?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return e.apply(r,o)})}return e.apply(this,arguments)}}var et={},_o=100,wo=20,Nr=100,Fn=typeof Promise=="undefined"?[]:function(){var t=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[t,Ze(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Ze(e),t]}(),sn=Fn[0],Ot=Fn[1],un=Fn[2],Vr=Ot&&Ot.then,wt=sn&&sn.constructor,Ln=!!un,cn=!1,ko=un?function(){un.then(dt)}:N.setImmediate?setImmediate.bind(null,dt):N.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){dt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(dt,0)},tt=function(t,e){Qe.push([t,e]),Dt&&(ko(),Dt=!1)},ln=!0,Dt=!0,Ae=[],kt=[],fn=null,hn=st,Me={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:fr,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{fr(t[0],t[1])}catch{}})}},B=Me,Qe=[],Ie=0,xt=[];function A(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=F,this._lib=!1;var e=this._PSD=B;if(ae&&(this._stackHolder=Oe(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==et)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&pn(this,this._value);return}this._state=null,this._value=null,++e.ref,Ur(this,t)}var dn={get:function(){var t=B,e=Pt;function n(r,i){var o=this,a=!t.global&&(t!==B||e!==Pt),s=a&&!de(),c=new A(function(u,l){Nn(o,new zr(Tt(r,t,a,s),Tt(i,t,a,s),u,l,t))});return ae&&$r(c,this),c}return n.prototype=et,n},set:function(t){he(this,"then",t&&t.prototype===et?dn:{get:function(){return t},set:dn.set})}};Fe(A.prototype,{then:dn,_then:function(t,e){Nn(this,new zr(null,null,t,e,B))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,function(r){return r instanceof e?n(r):Et(r)}):this.then(null,function(r){return r&&r.name===e?n(r):Et(r)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),Et(e)})},stack:{get:function(){if(this._stack)return this._stack;try{cn=!0;var t=Hr(this,[],wo),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{cn=!1}}},timeout:function(t,e){var n=this;return t<1/0?new A(function(r,i){var o=setTimeout(function(){return i(new O.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&he(A.prototype,Symbol.toStringTag,"Dexie.Promise");Me.env=Qr();function zr(t,e,n,r,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=i}Fe(A,{all:function(){var t=ce.apply(null,arguments).map(Kt);return new A(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach(function(i,o){return A.resolve(i).then(function(a){t[o]=a,--r||e(t)},n)})})},resolve:function(t){if(t instanceof A)return t;if(t&&typeof t.then=="function")return new A(function(n,r){t.then(n,r)});var e=new A(et,!0,t);return $r(e,fn),e},reject:Et,race:function(){var t=ce.apply(null,arguments).map(Kt);return new A(function(e,n){t.map(function(r){return A.resolve(r).then(e,n)})})},PSD:{get:function(){return B},set:function(t){return B=t}},totalEchoes:{get:function(){return Pt}},newPSD:we,usePSD:ze,scheduler:{get:function(){return tt},set:function(t){tt=t}},rejectionMapper:{get:function(){return hn},set:function(t){hn=t}},follow:function(t,e){return new A(function(n,r){return we(function(i,o){var a=B;a.unhandleds=[],a.onunhandled=o,a.finalize=Be(function(){var s=this;Eo(function(){s.unhandleds.length===0?i():o(s.unhandleds[0])})},a.finalize),t()},e,n,r)})}});wt&&(wt.allSettled&&he(A,"allSettled",function(){var t=ce.apply(null,arguments).map(Kt);return new A(function(e){t.length===0&&e([]);var n=t.length,r=new Array(n);t.forEach(function(i,o){return A.resolve(i).then(function(a){return r[o]={status:"fulfilled",value:a}},function(a){return r[o]={status:"rejected",reason:a}}).then(function(){return--n||e(r)})})})}),wt.any&&typeof AggregateError!="undefined"&&he(A,"any",function(){var t=ce.apply(null,arguments).map(Kt);return new A(function(e,n){t.length===0&&n(new AggregateError([]));var r=t.length,i=new Array(r);t.forEach(function(o,a){return A.resolve(o).then(function(s){return e(s)},function(s){i[a]=s,--r||n(new AggregateError(i))})})})}));function Ur(t,e){try{e(function(n){if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&ut();n&&typeof n.then=="function"?Ur(t,function(i,o){n instanceof A?n._then(i,o):n.then(i,o)}):(t._state=!0,t._value=n,qr(t)),r&&ct()}},pn.bind(null,t))}catch(n){pn(t,n)}}function pn(t,e){if(kt.push(e),t._state===null){var n=t._lib&&ut();e=hn(e),t._state=!1,t._value=e,ae&&e!==null&&typeof e=="object"&&!e._promise&&ro(function(){var r=Pn(e,"stack");e._promise=t,he(e,"stack",{get:function(){return cn?r&&(r.get?r.get.apply(e):r.value):t.stack}})}),So(t),qr(t),n&&ct()}}function qr(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Nn(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),Ie===0&&(++Ie,tt(function(){--Ie===0&&Vn()},[]))}function Nn(t,e){if(t._state===null){t._listeners.push(e);return}var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Ie,tt(xo,[n,t,e])}function xo(t,e,n){try{fn=e;var r,i=e._value;e._state?r=t(i):(kt.length&&(kt=[]),r=t(i),kt.indexOf(i)===-1&&Co(e)),n.resolve(r)}catch(o){n.reject(o)}finally{fn=null,--Ie===0&&Vn(),--n.psd.ref||n.psd.finalize()}}function Hr(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var i=t._value,o,a;i!=null?(o=i.name||"Error",a=i.message||i,r=an(i,0)):(o=i,a=""),e.push(o+(a?": "+a:"")+r)}return ae&&(r=an(t._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),t._prev&&Hr(t._prev,e,n)),e}function $r(t,e){var n=e?e._numPrev+1:0;n<_o&&(t._prev=e,t._numPrev=n)}function dt(){ut()&&ct()}function ut(){var t=ln;return ln=!1,Dt=!1,t}function ct(){var t,e,n;do for(;Qe.length>0;)for(t=Qe,Qe=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(Qe.length>0);ln=!0,Dt=!0}function Vn(){var t=Ae;Ae=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var e=xt.slice(0),n=e.length;n;)e[--n]()}function Eo(t){function e(){t(),xt.splice(xt.indexOf(e),1)}xt.push(e),++Ie,tt(function(){--Ie===0&&Vn()},[])}function So(t){Ae.some(function(e){return e._value===t._value})||Ae.push(t)}function Co(t){for(var e=Ae.length;e;)if(Ae[--e]._value===t._value){Ae.splice(e,1);return}}function Et(t){return new A(et,!1,t)}function V(t,e){var n=B;return function(){var r=ut(),i=B;try{return ke(n,!0),t.apply(this,arguments)}catch(o){e&&e(o)}finally{ke(i,!1),r&&ct()}}}var H={awaits:0,echoes:0,id:0},Ao=0,St=[],Ht=0,Pt=0,Io=0;function we(t,e,n,r){var i=B,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Io;var a=Me.env;o.env=Ln?{Promise:A,PromiseProp:{value:A,configurable:!0,writable:!0},all:A.all,race:A.race,allSettled:A.allSettled,any:A.any,resolve:A.resolve,reject:A.reject,nthen:cr(a.nthen,o),gthen:cr(a.gthen,o)}:{},e&&G(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=ze(o,t,n,r);return o.ref===0&&o.finalize(),s}function Ve(){return H.id||(H.id=++Ao),++H.awaits,H.echoes+=Nr,H.id}function de(){return H.awaits?(--H.awaits===0&&(H.id=0),H.echoes=H.awaits*Nr,!0):!1}(""+Vr).indexOf("[native code]")===-1&&(Ve=de=F);function Kt(t){return H.echoes&&t&&t.constructor===wt?(Ve(),t.then(function(e){return de(),e},function(e){return de(),q(e)})):t}function Bo(t){++Pt,(!H.echoes||--H.echoes===0)&&(H.echoes=H.id=0),St.push(B),ke(t,!0)}function Ro(){var t=St[St.length-1];St.pop(),ke(t,!1)}function ke(t,e){var n=B;if((e?H.echoes&&(!Ht++||t!==B):Ht&&(!--Ht||t!==B))&&Wr(e?Bo.bind(null,t):Ro),t!==B&&(B=t,n===Me&&(Me.env=Qr()),Ln)){var r=Me.env.Promise,i=t.env;Ot.then=i.nthen,r.prototype.then=i.gthen,(n.global||t.global)&&(Object.defineProperty(N,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Qr(){var t=N.Promise;return Ln?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(N,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Ot.then,gthen:t.prototype.then}:{}}function ze(t,e,n,r,i){var o=B;try{return ke(t,!0),e(n,r,i)}finally{ke(o,!1)}}function Wr(t){Vr.call(sn,t)}function Tt(t,e,n,r){return typeof t!="function"?t:function(){var i=B;n&&Ve(),ke(e,!0);try{return t.apply(this,arguments)}finally{ke(i,!1),r&&Wr(de)}}}function cr(t,e){return function(n,r){return t.call(this,Tt(n,e),Tt(r,e))}}var lr="unhandledrejection";function fr(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,i={promise:e,reason:t};if(N.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(lr,!0,!0),G(r,i)):N.CustomEvent&&(r=new CustomEvent(lr,{detail:i}),G(r,i)),r&&N.dispatchEvent&&(dispatchEvent(r),!N.PromiseRejectionEvent&&N.onunhandledrejection))try{N.onunhandledrejection(r)}catch{}ae&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch{}}var q=A.reject;function mn(t,e,n,r){if(!t.idbdb||!t._state.openComplete&&!B.letThrough&&!t._vip){if(t._state.openComplete)return q(new O.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return q(new O.DatabaseClosed);t.open().catch(F)}return t._state.dbReadyPromise.then(function(){return mn(t,e,n,r)})}else{var i=t._createTransaction(e,n,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(o){return o.name===jn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return mn(t,e,n,r)})):q(o)}return i._promise(e,function(o,a){return we(function(){return B.trans=i,r(o,a,i)})}).then(function(o){return i._completion.then(function(){return o})})}}var hr="3.2.5",Ce=String.fromCharCode(65535),vn=-1/0,se="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Gr="String expected.",Ye=[],zt=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Oo=zt,Do=zt,Yr=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},Ut="__dbnames",$t="readonly",Qt="readwrite";function Re(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var Jr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function pt(t){return typeof t=="string"&&!/\./.test(t)?function(e){return e[t]===void 0&&t in e&&(e=at(e),delete e[t]),e}:function(e){return e}}var Po=function(){function t(){}return t.prototype._trans=function(e,n,r){var i=this._tx||B.trans,o=this.name;function a(c,u,l){if(!l.schema[o])throw new O.NotFound("Table "+o+" not part of transaction");return n(l.idbtrans,l)}var s=ut();try{return i&&i.db===this.db?i===B.trans?i._promise(e,a,r):we(function(){return i._promise(e,a,r)},{trans:i,transless:B.transless||B}):mn(this.db,e,[this.name],a)}finally{s&&ct()}},t.prototype.get=function(e,n){var r=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(o){return r.hook.reading.fire(o)})}).then(n)},t.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if($(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=U(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(h){if(h.compound&&n.every(function(v){return h.keyPath.indexOf(v)>=0})){for(var f=0;f<n.length;++f)if(n.indexOf(h.keyPath[f])===-1)return!1;return!0}return!1}).sort(function(h,f){return h.keyPath.length-f.keyPath.length})[0];if(r&&this.db._maxKey!==Ce){var i=r.keyPath.slice(0,n.length);return this.where(i).equals(i.map(function(h){return e[h]}))}!r&&ae&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var o=this.schema.idxByName,a=this.db._deps.indexedDB;function s(h,f){try{return a.cmp(h,f)===0}catch{return!1}}var c=n.reduce(function(h,f){var v=h[0],d=h[1],m=o[f],g=e[f];return[v||m,v||!m?Re(d,m&&m.multi?function(w){var y=fe(w,f);return $(y)&&y.some(function(p){return s(g,p)})}:function(w){return s(g,fe(w,f))}):d]},[null,null]),u=c[0],l=c[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,$(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(r){if(!r)return r;var i=Object.create(e.prototype);for(var o in r)if(X(r,o))try{i[o]=r[o]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},t.prototype.defineClass=function(){function e(n){G(this,n)}return this.mapToClass(e)},t.prototype.add=function(e,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,s=e;return a&&o&&(s=pt(a)(e)),this._trans("readwrite",function(c){return r.core.mutate({trans:c,type:"add",keys:n!=null?[n]:null,values:[s]})}).then(function(c){return c.numFailures?A.reject(c.failures[0]):c.lastResult}).then(function(c){if(a)try{ne(e,a,c)}catch{}return c})},t.prototype.update=function(e,n){if(typeof e=="object"&&!$(e)){var r=fe(e,this.schema.primKey.keyPath);if(r===void 0)return q(new O.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?U(n).forEach(function(i){ne(e,i,n[i])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(e).modify(n)},t.prototype.put=function(e,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,s=e;return a&&o&&(s=pt(a)(e)),this._trans("readwrite",function(c){return r.core.mutate({trans:c,type:"put",values:[s],keys:n!=null?[n]:null})}).then(function(c){return c.numFailures?A.reject(c.failures[0]):c.lastResult}).then(function(c){if(a)try{ne(e,a,c)}catch{}return c})},t.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?A.reject(r.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:Jr})}).then(function(n){return n.numFailures?A.reject(n.failures[0]):void 0})},t.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(o){return n.hook.reading.fire(o)})})})},t.prototype.bulkAdd=function(e,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var a=r?r.allKeys:void 0;return this._trans("readwrite",function(s){var c=i.schema.primKey,u=c.auto,l=c.keyPath;if(l&&o)throw new O.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new O.InvalidArgument("Arguments objects and keys must have the same length");var h=e.length,f=l&&u?e.map(pt(l)):e;return i.core.mutate({trans:s,type:"add",keys:o,values:f,wantResults:a}).then(function(v){var d=v.numFailures,m=v.results,g=v.lastResult,w=v.failures,y=a?m:g;if(d===0)return y;throw new Ge(i.name+".bulkAdd(): "+d+" of "+h+" operations failed",w)})})},t.prototype.bulkPut=function(e,n,r){var i=this,o=Array.isArray(n)?n:void 0;r=r||(o?void 0:n);var a=r?r.allKeys:void 0;return this._trans("readwrite",function(s){var c=i.schema.primKey,u=c.auto,l=c.keyPath;if(l&&o)throw new O.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new O.InvalidArgument("Arguments objects and keys must have the same length");var h=e.length,f=l&&u?e.map(pt(l)):e;return i.core.mutate({trans:s,type:"put",keys:o,values:f,wantResults:a}).then(function(v){var d=v.numFailures,m=v.results,g=v.lastResult,w=v.failures,y=a?m:g;if(d===0)return y;throw new Ge(i.name+".bulkPut(): "+d+" of "+h+" operations failed",w)})})},t.prototype.bulkDelete=function(e){var n=this,r=e.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:e})}).then(function(i){var o=i.numFailures,a=i.lastResult,s=i.failures;if(o===0)return a;throw new Ge(n.name+".bulkDelete(): "+o+" of "+r+" operations failed",s)})},t}();function lt(t){var e={},n=function(s,c){if(c){for(var u=arguments.length,l=new Array(u-1);--u;)l[u-1]=arguments[u];return e[s].subscribe.apply(null,l),t}else if(typeof s=="string")return e[s]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return n;function o(s,c,u){if(typeof s=="object")return a(s);c||(c=bo),u||(u=F);var l={subscribers:[],fire:u,subscribe:function(h){l.subscribers.indexOf(h)===-1&&(l.subscribers.push(h),l.fire=c(l.fire,h))},unsubscribe:function(h){l.subscribers=l.subscribers.filter(function(f){return f!==h}),l.fire=l.subscribers.reduce(c,u)}};return e[s]=n[s]=l,l}function a(s){U(s).forEach(function(c){var u=s[c];if($(u))o(c,s[c][0],s[c][1]);else if(u==="asap")var l=o(c,st,function(){for(var f=arguments.length,v=new Array(f);f--;)v[f]=arguments[f];l.subscribers.forEach(function(d){Or(function(){d.apply(null,v)})})});else throw new O.InvalidArgument("Invalid event config")})}}function ft(t,e){return Le(e).from({prototype:t}),e}function Ko(t){return ft(Po.prototype,function(n,r,i){this.db=t,this._tx=i,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:lt(null,{creating:[vo,F],reading:[mo,st],updating:[go,F],deleting:[yo,F]})})}function Pe(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Wt(t,e){t.filter=Re(t.filter,e)}function Gt(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return Re(r(),e())}:e,t.justLimit=n&&!r}function To(t,e){t.isMatch=Re(t.isMatch,e)}function Ct(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(!n)throw new O.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function dr(t,e,n){var r=Ct(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function mt(t,e,n,r){var i=t.replayFilter?Re(t.filter,t.replayFilter()):t.filter;if(t.or){var o={},a=function(s,c,u){if(!i||i(c,u,function(f){return c.stop(f)},function(f){return c.fail(f)})){var l=c.primaryKey,h=""+l;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(l)),X(o,h)||(o[h]=!0,e(s,c,u))}};return Promise.all([t.or._iterate(a,n),pr(dr(t,r,n),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}else return pr(dr(t,r,n),Re(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function pr(t,e,n,r){var i=r?function(a,s,c){return n(r(a),s,c)}:n,o=V(i);return t.then(function(a){if(a)return a.start(function(){var s=function(){return a.continue()};(!e||e(a,function(c){return s=c},function(c){a.stop(c),s=F},function(c){a.fail(c),s=F}))&&o(a.value,a,function(c){return s=c}),s()})})}function W(t,e){try{var n=mr(t),r=mr(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return Mo(vr(t),vr(e));case"Array":return jo(t,e)}}catch{}return NaN}function jo(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,o=0;o<i;++o){var a=W(t[o],e[o]);if(a!==0)return a}return n===r?0:n<r?-1:1}function Mo(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,o=0;o<i;++o)if(t[o]!==e[o])return t[o]<e[o]?-1:1;return n===r?0:n<r?-1:1}function mr(t){var e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";var n=rn(t);return n==="ArrayBuffer"?"binary":n}function vr(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var Fo=function(){function t(){}return t.prototype._read=function(e,n){var r=this._ctx;return r.error?r.table._trans(null,q.bind(null,r.error)):r.table._trans("readonly",e).then(n)},t.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,q.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Re(n.algorithm,e)},t.prototype._iterate=function(e,n){return mt(this._ctx,e,n,this._ctx.table.core)},t.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&G(r,e),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var n=this._ctx;return this._read(function(r){return mt(n,e,r,n.table.core)})},t.prototype.count=function(e){var n=this;return this._read(function(r){var i=n._ctx,o=i.table.core;if(Pe(i,!0))return o.count({trans:r,query:{index:Ct(i,o.schema),range:i.range}}).then(function(s){return Math.min(s,i.limit)});var a=0;return mt(i,function(){return++a,!1},r,o).then(function(){return a})}).then(e)},t.prototype.sortBy=function(e,n){var r=e.split(".").reverse(),i=r[0],o=r.length-1;function a(u,l){return l?a(u[r[l]],l-1):u[i]}var s=this._ctx.dir==="next"?1:-1;function c(u,l){var h=a(u,o),f=a(l,o);return h<f?-s:h>f?s:0}return this.toArray(function(u){return u.sort(c)}).then(n)},t.prototype.toArray=function(e){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Pe(i,!0)&&i.limit>0){var o=i.valueMapper,a=Ct(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:a,range:i.range}}).then(function(c){var u=c.result;return o?u.map(o):u})}else{var s=[];return mt(i,function(c){return s.push(c)},r,i.table.core).then(function(){return s})}},e)},t.prototype.offset=function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,Pe(n)?Gt(n,function(){var r=e;return function(i,o){return r===0?!0:r===1?(--r,!1):(o(function(){i.advance(r),r=0}),!1)}}):Gt(n,function(){var r=e;return function(){return--r<0}}),this)},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Gt(this._ctx,function(){var n=e;return function(r,i,o){return--n<=0&&i(o),n>=0}},!0),this},t.prototype.until=function(e,n){return Wt(this._ctx,function(r,i,o){return e(r.value)?(i(o),n):!0}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return Wt(this._ctx,function(n){return e(n.value)}),To(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.key,i)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},t.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.key)}).then(function(){return r}).then(e)},t.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&Pe(n,!0)&&n.limit>0)return this._read(function(i){var o=Ct(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:o,range:n.range}})}).then(function(i){var o=i.result;return o}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,o){r.push(o.primaryKey)}).then(function(){return r}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return Wt(this._ctx,function(i){var o=i.primaryKey.toString(),a=X(r,o);return r[o]=!0,!a}),this},t.prototype.modify=function(e){var n=this,r=this._ctx;return this._write(function(i){var o;if(typeof e=="function")o=e;else{var a=U(e),s=a.length;o=function(w){for(var y=!1,p=0;p<s;++p){var _=a[p],b=e[_];fe(w,_)!==b&&(ne(w,_,b),y=!0)}return y}}var c=r.table.core,u=c.schema.primaryKey,l=u.outbound,h=u.extractKey,f=n.db._options.modifyChunkSize||200,v=[],d=0,m=[],g=function(w,y){var p=y.failures,_=y.numFailures;d+=w-_;for(var b=0,k=U(p);b<k.length;b++){var S=k[b];v.push(p[S])}};return n.clone().primaryKeys().then(function(w){var y=function(p){var _=Math.min(f,w.length-p);return c.getMany({trans:i,keys:w.slice(p,p+_),cache:"immutable"}).then(function(b){for(var k=[],S=[],x=l?[]:null,E=[],I=0;I<_;++I){var D=b[I],K={value:at(D),primKey:w[p+I]};o.call(K,K.value,K)!==!1&&(K.value==null?E.push(w[p+I]):!l&&W(h(D),h(K.value))!==0?(E.push(w[p+I]),k.push(K.value)):(S.push(K.value),l&&x.push(w[p+I])))}var j=Pe(r)&&r.limit===1/0&&(typeof e!="function"||e===Yt)&&{index:r.index,range:r.range};return Promise.resolve(k.length>0&&c.mutate({trans:i,type:"add",values:k}).then(function(P){for(var R in P.failures)E.splice(parseInt(R),1);g(k.length,P)})).then(function(){return(S.length>0||j&&typeof e=="object")&&c.mutate({trans:i,type:"put",keys:x,values:S,criteria:j,changeSpec:typeof e!="function"&&e}).then(function(P){return g(S.length,P)})}).then(function(){return(E.length>0||j&&e===Yt)&&c.mutate({trans:i,type:"delete",keys:E,criteria:j}).then(function(P){return g(E.length,P)})}).then(function(){return w.length>p+_&&y(p+f)})})};return y(0).then(function(){if(v.length>0)throw new Rt("Error modifying one or more objects",v,d,m);return w.length})})})},t.prototype.delete=function(){var e=this._ctx,n=e.range;return Pe(e)&&(e.isPrimKey&&!Do||n.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,o=n;return e.table.core.count({trans:r,query:{index:i,range:o}}).then(function(a){return e.table.core.mutate({trans:r,type:"deleteRange",range:o}).then(function(s){var c=s.failures;s.lastResult,s.results;var u=s.numFailures;if(u)throw new Rt("Could not delete some values",Object.keys(c).map(function(l){return c[l]}),a-u);return a-u})})}):this.modify(Yt)},t}(),Yt=function(t,e){return e.value=null};function Lo(t){return ft(Fo.prototype,function(n,r){this.db=t;var i=Jr,o=null;if(r)try{i=r()}catch(u){o=u}var a=n._ctx,s=a.table,c=s.hook.reading.fire;this._ctx={table:s,index:a.index,isPrimKey:!a.index||s.schema.primKey.keyPath&&a.index===s.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:a.or,valueMapper:c!==st?c:null}})}function No(t,e){return t<e?-1:t===e?0:1}function Vo(t,e){return t>e?-1:t===e?0:1}function J(t,e,n){var r=t instanceof Zr?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function Ke(t){return new t.Collection(t,function(){return Xr("")}).limit(0)}function zo(t){return t==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function Uo(t){return t==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function qo(t,e,n,r,i,o){for(var a=Math.min(t.length,r.length),s=-1,c=0;c<a;++c){var u=e[c];if(u!==r[c])return i(t[c],n[c])<0?t.substr(0,c)+n[c]+n.substr(c+1):i(t[c],r[c])<0?t.substr(0,c)+r[c]+n.substr(c+1):s>=0?t.substr(0,s)+e[s]+n.substr(s+1):null;i(t[c],u)<0&&(s=c)}return a<r.length&&o==="next"?t+n.substr(t.length):a<t.length&&o==="prev"?t.substr(0,n.length):s<0?null:t.substr(0,s)+r[s]+n.substr(s+1)}function vt(t,e,n,r){var i,o,a,s,c,u,l,h=n.length;if(!n.every(function(m){return typeof m=="string"}))return J(t,Gr);function f(m){i=zo(m),o=Uo(m),a=m==="next"?No:Vo;var g=n.map(function(w){return{lower:o(w),upper:i(w)}}).sort(function(w,y){return a(w.lower,y.lower)});s=g.map(function(w){return w.upper}),c=g.map(function(w){return w.lower}),u=m,l=m==="next"?"":r}f("next");var v=new t.Collection(t,function(){return ge(s[0],c[h-1]+r)});v._ondirectionchange=function(m){f(m)};var d=0;return v._addAlgorithm(function(m,g,w){var y=m.key;if(typeof y!="string")return!1;var p=o(y);if(e(p,c,d))return!0;for(var _=null,b=d;b<h;++b){var k=qo(y,p,s[b],c[b],a,u);k===null&&_===null?d=b+1:(_===null||a(_,k)>0)&&(_=k)}return g(_!==null?function(){m.continue(_+l)}:w),!1}),v}function ge(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function Xr(t){return{type:1,lower:t,upper:t}}var Zr=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||i)&&!(r&&i)?Ke(this):new this.Collection(this,function(){return ge(e,n,!r,!i)})}catch{return J(this,se)}},t.prototype.equals=function(e){return e==null?J(this,se):new this.Collection(this,function(){return Xr(e)})},t.prototype.above=function(e){return e==null?J(this,se):new this.Collection(this,function(){return ge(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return e==null?J(this,se):new this.Collection(this,function(){return ge(e,void 0,!1)})},t.prototype.below=function(e){return e==null?J(this,se):new this.Collection(this,function(){return ge(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return e==null?J(this,se):new this.Collection(this,function(){return ge(void 0,e)})},t.prototype.startsWith=function(e){return typeof e!="string"?J(this,Gr):this.between(e,e+Ce,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):vt(this,function(n,r){return n.indexOf(r[0])===0},[e],Ce)},t.prototype.equalsIgnoreCase=function(e){return vt(this,function(n,r){return n===r[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=ce.apply(Te,arguments);return e.length===0?Ke(this):vt(this,function(n,r){return r.indexOf(n)!==-1},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=ce.apply(Te,arguments);return e.length===0?Ke(this):vt(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},e,Ce)},t.prototype.anyOf=function(){var e=this,n=ce.apply(Te,arguments),r=this._cmp;try{n.sort(r)}catch{return J(this,se)}if(n.length===0)return Ke(this);var i=new this.Collection(this,function(){return ge(n[0],n[n.length-1])});i._ondirectionchange=function(a){r=a==="next"?e._ascending:e._descending,n.sort(r)};var o=0;return i._addAlgorithm(function(a,s,c){for(var u=a.key;r(u,n[o])>0;)if(++o,o===n.length)return s(c),!1;return r(u,n[o])===0?!0:(s(function(){a.continue(n[o])}),!1)}),i},t.prototype.notEqual=function(e){return this.inAnyRange([[vn,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=ce.apply(Te,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return J(this,se)}var n=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[vn,i]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,n){var r=this,i=this._cmp,o=this._ascending,a=this._descending,s=this._min,c=this._max;if(e.length===0)return Ke(this);if(!e.every(function(b){return b[0]!==void 0&&b[1]!==void 0&&o(b[0],b[1])<=0}))return J(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",O.InvalidArgument);var u=!n||n.includeLowers!==!1,l=n&&n.includeUppers===!0;function h(b,k){for(var S=0,x=b.length;S<x;++S){var E=b[S];if(i(k[0],E[1])<0&&i(k[1],E[0])>0){E[0]=s(E[0],k[0]),E[1]=c(E[1],k[1]);break}}return S===x&&b.push(k),b}var f=o;function v(b,k){return f(b[0],k[0])}var d;try{d=e.reduce(h,[]),d.sort(v)}catch{return J(this,se)}var m=0,g=l?function(b){return o(b,d[m][1])>0}:function(b){return o(b,d[m][1])>=0},w=u?function(b){return a(b,d[m][0])>0}:function(b){return a(b,d[m][0])>=0};function y(b){return!g(b)&&!w(b)}var p=g,_=new this.Collection(this,function(){return ge(d[0][0],d[d.length-1][1],!u,!l)});return _._ondirectionchange=function(b){b==="next"?(p=g,f=o):(p=w,f=a),d.sort(v)},_._addAlgorithm(function(b,k,S){for(var x=b.key;p(x);)if(++m,m===d.length)return k(S),!1;return y(x)?!0:(r._cmp(x,d[m][1])===0||r._cmp(x,d[m][0])===0||k(function(){f===o?b.continue(d[m][0]):b.continue(d[m][1])}),!1)}),_},t.prototype.startsWithAnyOf=function(){var e=ce.apply(Te,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?Ke(this):this.inAnyRange(e.map(function(n){return[n,n+Ce]})):J(this,"startsWithAnyOf() only works with strings")},t}();function Ho(t){return ft(Zr.prototype,function(n,r,i){this.db=t,this._ctx={table:n,index:r===":id"?null:r,or:i};var o=t._deps.indexedDB;if(!o)throw new O.MissingAPI;this._cmp=this._ascending=o.cmp.bind(o),this._descending=function(a,s){return o.cmp(s,a)},this._max=function(a,s){return o.cmp(a,s)>0?a:s},this._min=function(a,s){return o.cmp(a,s)<0?a:s},this._IDBKeyRange=t._deps.IDBKeyRange})}function oe(t){return V(function(e){return nt(e),t(e.target.error),!1})}function nt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var rt="storagemutated",_e="x-storagemutated-1",xe=lt(null,rt),$o=function(){function t(){}return t.prototype._lock=function(){return $e(!B.global),++this._reculock,this._reculock===1&&!B.global&&(B.lockOwnerFor=this),this},t.prototype._unlock=function(){if($e(!B.global),--this._reculock===0)for(B.global||(B.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ze(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&B.lockOwnerFor!==this},t.prototype.create=function(e){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if($e(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new O.DatabaseClosed(i);case"MissingAPIError":throw new O.MissingAPI(i.message,i);default:throw new O.OpenFailed(i)}if(!this.active)throw new O.TransactionInactive;return $e(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=V(function(o){nt(o),n._reject(e.error)}),e.onabort=V(function(o){nt(o),n.active&&n._reject(new O.Abort(e.error)),n.active=!1,n.on("abort").fire(o)}),e.oncomplete=V(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&xe.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,n,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return q(new O.ReadOnly("Transaction is readonly"));if(!this.active)return q(new O.TransactionInactive);if(this._locked())return new A(function(a,s){i._blockedFuncs.push([function(){i._promise(e,n,r).then(a,s)},B])});if(r)return we(function(){var a=new A(function(s,c){i._lock();var u=n(s,c,i);u&&u.then&&u.then(s,c)});return a.finally(function(){return i._unlock()}),a._lib=!0,a});var o=new A(function(a,s){var c=n(a,s,i);c&&c.then&&c.then(a,s)});return o._lib=!0,o},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var n=this._root(),r=A.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=a)})()}var o=n._waitingFor;return new A(function(a,s){r.then(function(c){return n._waitingQueue.push(V(a.bind(null,c)))},function(c){return n._waitingQueue.push(V(s.bind(null,c)))}).finally(function(){n._waitingFor===o&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new O.Abort))},t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(X(n,e))return n[e];var r=this.schema[e];if(!r)throw new O.NotFound("Table "+e+" not part of transaction");var i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),n[e]=i,i},t}();function Qo(t){return ft($o.prototype,function(n,r,i,o,a){var s=this;this.db=t,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=lt(this,"complete","error","abort"),this.parent=a||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new A(function(c,u){s._resolve=c,s._reject=u}),this._completion.then(function(){s.active=!1,s.on.complete.fire()},function(c){var u=s.active;return s.active=!1,s.on.error.fire(c),s.parent?s.parent._reject(c):u&&s.idbtrans&&s.idbtrans.abort(),q(c)})})}function yn(t,e,n,r,i,o,a){return{name:t,keyPath:e,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+ei(e)}}function ei(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function ti(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Dr(n,function(r){return[r.name,r]})}}function Wo(t){return t.length===1?t[0]:t}var it=function(t){try{return t.only([[]]),it=function(){return[[]]},[[]]}catch{return it=function(){return Ce},Ce}};function gn(t){return t==null?function(){}:typeof t=="string"?Go(t):function(e){return fe(e,t)}}function Go(t){var e=t.split(".");return e.length===1?function(n){return n[t]}:function(n){return fe(n,t)}}function yr(t){return[].slice.call(t)}var Yo=0;function Je(t){return t==null?":id":typeof t=="string"?t:"["+t.join("+")+"]"}function Jo(t,e,n){function r(h,f){var v=yr(h.objectStoreNames);return{schema:{name:h.name,tables:v.map(function(d){return f.objectStore(d)}).map(function(d){var m=d.keyPath,g=d.autoIncrement,w=$(m),y=m==null,p={},_={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y,compound:w,keyPath:m,autoIncrement:g,unique:!0,extractKey:gn(m)},indexes:yr(d.indexNames).map(function(b){return d.index(b)}).map(function(b){var k=b.name,S=b.unique,x=b.multiEntry,E=b.keyPath,I=$(E),D={name:k,compound:I,keyPath:E,unique:S,multiEntry:x,extractKey:gn(E)};return p[Je(E)]=D,D}),getIndexByKeyPath:function(b){return p[Je(b)]}};return p[":id"]=_.primaryKey,m!=null&&(p[Je(m)]=_.primaryKey),_})},hasGetAll:v.length>0&&"getAll"in f.objectStore(v[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(h){if(h.type===3)return null;if(h.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var f=h.lower,v=h.upper,d=h.lowerOpen,m=h.upperOpen,g=f===void 0?v===void 0?null:e.upperBound(v,!!m):v===void 0?e.lowerBound(f,!!d):e.bound(f,v,!!d,!!m);return g}function o(h){var f=h.name;function v(g){var w=g.trans,y=g.type,p=g.keys,_=g.values,b=g.range;return new Promise(function(k,S){k=V(k);var x=w.objectStore(f),E=x.keyPath==null,I=y==="put"||y==="add";if(!I&&y!=="delete"&&y!=="deleteRange")throw new Error("Invalid operation type: "+y);var D=(p||_||{length:1}).length;if(p&&_&&p.length!==_.length)throw new Error("Given keys array must have same length as given values array.");if(D===0)return k({numFailures:0,failures:{},results:[],lastResult:void 0});var K,j=[],P=[],R=0,L=function(ie){++R,nt(ie)};if(y==="deleteRange"){if(b.type===4)return k({numFailures:R,failures:P,results:[],lastResult:void 0});b.type===3?j.push(K=x.clear()):j.push(K=x.delete(i(b)))}else{var Y=I?E?[_,p]:[_,null]:[p,null],pe=Y[0],re=Y[1];if(I)for(var Z=0;Z<D;++Z)j.push(K=re&&re[Z]!==void 0?x[y](pe[Z],re[Z]):x[y](pe[Z])),K.onerror=L;else for(var Z=0;Z<D;++Z)j.push(K=x[y](pe[Z])),K.onerror=L}var me=function(ie){var Ue=ie.target.result;j.forEach(function(te,ht){return te.error!=null&&(P[ht]=te.error)}),k({numFailures:R,failures:P,results:y==="delete"?p:j.map(function(te){return te.result}),lastResult:Ue})};K.onerror=function(ie){L(ie),me(ie)},K.onsuccess=me})}function d(g){var w=g.trans,y=g.values,p=g.query,_=g.reverse,b=g.unique;return new Promise(function(k,S){k=V(k);var x=p.index,E=p.range,I=w.objectStore(f),D=x.isPrimaryKey?I:I.index(x.name),K=_?b?"prevunique":"prev":b?"nextunique":"next",j=y||!("openKeyCursor"in D)?D.openCursor(i(E),K):D.openKeyCursor(i(E),K);j.onerror=oe(S),j.onsuccess=V(function(P){var R=j.result;if(!R){k(null);return}R.___id=++Yo,R.done=!1;var L=R.continue.bind(R),Y=R.continuePrimaryKey;Y&&(Y=Y.bind(R));var pe=R.advance.bind(R),re=function(){throw new Error("Cursor not started")},Z=function(){throw new Error("Cursor not stopped")};R.trans=w,R.stop=R.continue=R.continuePrimaryKey=R.advance=re,R.fail=V(S),R.next=function(){var me=this,ie=1;return this.start(function(){return ie--?me.continue():me.stop()}).then(function(){return me})},R.start=function(me){var ie=new Promise(function(te,ht){te=V(te),j.onerror=oe(ht),R.fail=ht,R.stop=function(ci){R.stop=R.continue=R.continuePrimaryKey=R.advance=Z,te(ci)}}),Ue=function(){if(j.result)try{me()}catch(te){R.fail(te)}else R.done=!0,R.start=function(){throw new Error("Cursor behind last entry")},R.stop()};return j.onsuccess=V(function(te){j.onsuccess=Ue,Ue()}),R.continue=L,R.continuePrimaryKey=Y,R.advance=pe,Ue(),ie},k(R)},S)})}function m(g){return function(w){return new Promise(function(y,p){y=V(y);var _=w.trans,b=w.values,k=w.limit,S=w.query,x=k===1/0?void 0:k,E=S.index,I=S.range,D=_.objectStore(f),K=E.isPrimaryKey?D:D.index(E.name),j=i(I);if(k===0)return y({result:[]});if(g){var P=b?K.getAll(j,x):K.getAllKeys(j,x);P.onsuccess=function(pe){return y({result:pe.target.result})},P.onerror=oe(p)}else{var R=0,L=b||!("openKeyCursor"in K)?K.openCursor(j):K.openKeyCursor(j),Y=[];L.onsuccess=function(pe){var re=L.result;if(!re)return y({result:Y});if(Y.push(b?re.value:re.primaryKey),++R===k)return y({result:Y});re.continue()},L.onerror=oe(p)}})}}return{name:f,schema:h,mutate:v,getMany:function(g){var w=g.trans,y=g.keys;return new Promise(function(p,_){p=V(p);for(var b=w.objectStore(f),k=y.length,S=new Array(k),x=0,E=0,I,D=function(R){var L=R.target;(S[L._pos]=L.result)!=null,++E===x&&p(S)},K=oe(_),j=0;j<k;++j){var P=y[j];P!=null&&(I=b.get(y[j]),I._pos=j,I.onsuccess=D,I.onerror=K,++x)}x===0&&p(S)})},get:function(g){var w=g.trans,y=g.key;return new Promise(function(p,_){p=V(p);var b=w.objectStore(f),k=b.get(y);k.onsuccess=function(S){return p(S.target.result)},k.onerror=oe(_)})},query:m(c),openCursor:d,count:function(g){var w=g.query,y=g.trans,p=w.index,_=w.range;return new Promise(function(b,k){var S=y.objectStore(f),x=p.isPrimaryKey?S:S.index(p.name),E=i(_),I=E?x.count(E):x.count();I.onsuccess=V(function(D){return b(D.target.result)}),I.onerror=oe(k)})}}}var a=r(t,n),s=a.schema,c=a.hasGetAll,u=s.tables.map(function(h){return o(h)}),l={};return u.forEach(function(h){return l[h.name]=h}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(h){var f=l[h];if(!f)throw new Error("Table '"+h+"' not found");return l[h]},MIN_KEY:-1/0,MAX_KEY:it(e),schema:s}}function Xo(t,e){return e.reduce(function(n,r){var i=r.create;return T(T({},n),i(n))},t)}function Zo(t,e,n,r){var i=n.IDBKeyRange;n.indexedDB;var o=Xo(Jo(e,i,r),t.dbcore);return{dbcore:o}}function zn(t,e){var n=t._novip,r=e.db,i=Zo(n._middlewares,r,n._deps,e);n.core=i.dbcore,n.tables.forEach(function(o){var a=o.name;n.core.schema.tables.some(function(s){return s.name===a})&&(o.core=n.core.table(a),n[a]instanceof n.Table&&(n[a].core=o.core))})}function jt(t,e,n,r){var i=t._novip;n.forEach(function(o){var a=r[o];e.forEach(function(s){var c=Pn(s,o);(!c||"value"in c&&c.value===void 0)&&(s===i.Transaction.prototype||s instanceof i.Transaction?he(s,o,{get:function(){return this.table(o)},set:function(u){Br(this,o,{value:u,writable:!0,configurable:!0,enumerable:!0})}}):s[o]=new i.Table(o,a))})})}function bn(t,e){var n=t._novip;e.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function ea(t,e){return t._cfg.version-e._cfg.version}function ta(t,e,n,r){var i=t._dbSchema,o=t._createTransaction("readwrite",t._storeNames,i);o.create(n),o._completion.catch(r);var a=o._reject.bind(o),s=B.transless||B;we(function(){B.trans=o,B.transless=s,e===0?(U(i).forEach(function(c){Un(n,c,i[c].primKey,i[c].indexes)}),zn(t,n),A.follow(function(){return t.on.populate.fire(o)}).catch(a)):na(t,e,o,n).catch(a)})}function na(t,e,n,r){var i=t._novip,o=[],a=i._versions,s=i._dbSchema=qn(i,i.idbdb,r),c=!1,u=a.filter(function(h){return h._cfg.version>=e});u.forEach(function(h){o.push(function(){var f=s,v=h._cfg.dbschema;wn(i,f,r),wn(i,v,r),s=i._dbSchema=v;var d=ni(f,v);d.add.forEach(function(_){Un(r,_[0],_[1].primKey,_[1].indexes)}),d.change.forEach(function(_){if(_.recreate)throw new O.Upgrade("Not yet support for changing primary key");var b=r.objectStore(_.name);_.add.forEach(function(k){return _n(b,k)}),_.change.forEach(function(k){b.deleteIndex(k.name),_n(b,k)}),_.del.forEach(function(k){return b.deleteIndex(k)})});var m=h._cfg.contentUpgrade;if(m&&h._cfg.version>e){zn(i,r),n._memoizedTables={},c=!0;var g=Pr(v);d.del.forEach(function(_){g[_]=f[_]}),bn(i,[i.Transaction.prototype]),jt(i,[i.Transaction.prototype],U(g),g),n.schema=g;var w=Kn(m);w&&Ve();var y,p=A.follow(function(){if(y=m(n),y&&w){var _=de.bind(null,null);y.then(_,_)}});return y&&typeof y.then=="function"?A.resolve(y):p.then(function(){return y})}}),o.push(function(f){if(!c||!Oo){var v=h._cfg.dbschema;ia(v,f)}bn(i,[i.Transaction.prototype]),jt(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function l(){return o.length?A.resolve(o.shift()(n.idbtrans)).then(l):A.resolve()}return l().then(function(){ra(s,r)})}function ni(t,e){var n={del:[],add:[],change:[]},r;for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],o=e[r];if(!i)n.add.push([r,o]);else{var a={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!zt)a.recreate=!0,n.change.push(a);else{var s=i.idxByName,c=o.idxByName,u=void 0;for(u in s)c[u]||a.del.push(u);for(u in c){var l=s[u],h=c[u];l?l.src!==h.src&&a.change.push(h):a.add.push(h)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}}return n}function Un(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(o){return _n(i,o)}),i}function ra(t,e){U(t).forEach(function(n){e.db.objectStoreNames.contains(n)||Un(e,n,t[n].primKey,t[n].indexes)})}function ia(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(n){return t[n]==null&&e.db.deleteObjectStore(n)})}function _n(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function qn(t,e,n){var r={},i=Nt(e.objectStoreNames,0);return i.forEach(function(o){for(var a=n.objectStore(o),s=a.keyPath,c=yn(ei(s),s||"",!1,!1,!!a.autoIncrement,s&&typeof s!="string",!0),u=[],l=0;l<a.indexNames.length;++l){var h=a.index(a.indexNames[l]);s=h.keyPath;var f=yn(h.name,s,!!h.unique,!!h.multiEntry,!1,s&&typeof s!="string",!1);u.push(f)}r[o]=ti(o,c,u)}),r}function oa(t,e,n){var r=t._novip;r.verno=e.version/10;var i=r._dbSchema=qn(r,e,n);r._storeNames=Nt(e.objectStoreNames,0),jt(r,[r._allTables],U(i),i)}function aa(t,e){var n=qn(t,t.idbdb,e),r=ni(n,t._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function wn(t,e,n){for(var r=t._novip,i=n.db.objectStoreNames,o=0;o<i.length;++o){var a=i[o],s=n.objectStore(a);r._hasGetAll="getAll"in s;for(var c=0;c<s.indexNames.length;++c){var u=s.indexNames[c],l=s.index(u).keyPath,h=typeof l=="string"?l:"["+Nt(l).join("+")+"]";if(e[a]){var f=e[a].idxByName[h];f&&(f.name=u,delete e[a].idxByName[h],e[a].idxByName[u]=f)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&N.WorkerGlobalScope&&N instanceof N.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function sa(t){return t.split(",").map(function(e,n){e=e.trim();var r=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return yn(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),$(i),n===0)})}var ua=function(){function t(){}return t.prototype._parseStoresSpec=function(e,n){U(e).forEach(function(r){if(e[r]!==null){var i=sa(e[r]),o=i.shift();if(o.multi)throw new O.Schema("Primary key cannot be multi-valued");i.forEach(function(a){if(a.auto)throw new O.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new O.Schema("Index must have a name and cannot be an empty string")}),n[r]=ti(r,o,i)}})},t.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?G(this._cfg.storesSource,e):e;var r=n._versions,i={},o={};return r.forEach(function(a){G(i,a._cfg.storesSource),o=a._cfg.dbschema={},a._parseStoresSpec(i,o)}),n._dbSchema=o,bn(n,[n._allTables,n,n.Transaction.prototype]),jt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],U(o),o),n._storeNames=U(o),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Mn(this._cfg.contentUpgrade||F,e),this},t}();function ca(t){return ft(ua.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Hn(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Gn(Ut,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function $n(t){return t&&typeof t.databases=="function"}function la(t){var e=t.indexedDB,n=t.IDBKeyRange;return $n(e)?Promise.resolve(e.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==Ut})}):Hn(e,n).toCollection().primaryKeys()}function fa(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!$n(n)&&e!==Ut&&Hn(n,r).put({name:e}).catch(F)}function ha(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!$n(n)&&e!==Ut&&Hn(n,r).delete(e).catch(F)}function kn(t){return we(function(){return B.letThrough=!0,t()})}function da(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function pa(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?q(e.dbOpenError):t});ae&&(e.openCanceller._stackHolder=Oe()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new O.DatabaseClosed("db.open() was cancelled")}var o=e.dbReadyResolve,a=null,s=!1,c=function(){return new A(function(u,l){if(i(),!n)throw new O.MissingAPI;var h=t.name,f=e.autoSchema?n.open(h):n.open(h,Math.round(t.verno*10));if(!f)throw new O.MissingAPI;f.onerror=oe(l),f.onblocked=V(t._fireOnBlocked),f.onupgradeneeded=V(function(v){if(a=f.transaction,e.autoSchema&&!t._options.allowEmptyDB){f.onerror=nt,a.abort(),f.result.close();var d=n.deleteDatabase(h);d.onsuccess=d.onerror=V(function(){l(new O.NoSuchDatabase("Database "+h+" doesnt exist"))})}else{a.onerror=oe(l);var m=v.oldVersion>Math.pow(2,62)?0:v.oldVersion;s=m<1,t._novip.idbdb=f.result,ta(t,m/10,a,l)}},l),f.onsuccess=V(function(){a=null;var v=t._novip.idbdb=f.result,d=Nt(v.objectStoreNames);if(d.length>0)try{var m=v.transaction(Wo(d),"readonly");e.autoSchema?oa(t,v,m):(wn(t,t._dbSchema,m),aa(t,m)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),zn(t,m)}catch{}Ye.push(t),v.onversionchange=V(function(g){e.vcFired=!0,t.on("versionchange").fire(g)}),v.onclose=V(function(g){t.on("close").fire(g)}),s&&fa(t._deps,h),u()},l)}).catch(function(u){return u&&u.name==="UnknownError"&&e.PR1398_maxLoop>0?(e.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c()):A.reject(u)})};return A.race([r,(typeof navigator=="undefined"?A.resolve():da()).then(c)]).then(function(){return i(),e.onReadyBeingFired=[],A.resolve(kn(function(){return t.on.ready.fire(t.vip)})).then(function u(){if(e.onReadyBeingFired.length>0){var l=e.onReadyBeingFired.reduce(Mn,F);return e.onReadyBeingFired=[],A.resolve(kn(function(){return l(t.vip)})).then(u)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(u){e.dbOpenError=u;try{a&&a.abort()}catch{}return r===e.openCanceller&&t._close(),q(u)}).finally(function(){e.openComplete=!0,o()})}function xn(t){var e=function(a){return t.next(a)},n=function(a){return t.throw(a)},r=o(e),i=o(n);function o(a){return function(s){var c=a(s),u=c.value;return c.done?u:!u||typeof u.then!="function"?$(u)?Promise.all(u).then(r,i):r(u):u.then(r,i)}}return o(e)()}function ma(t,e,n){var r=arguments.length;if(r<2)throw new O.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=Kr(i);return[t,o,n]}function ri(t,e,n,r,i){return A.resolve().then(function(){var o=B.transless||B,a=t._createTransaction(e,n,t._dbSchema,r),s={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(h){return h.name===jn.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return ri(t,e,n,null,i)})):q(h)}var c=Kn(i);c&&Ve();var u,l=A.follow(function(){if(u=i.call(a,a),u)if(c){var h=de.bind(null,null);u.then(h,h)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=xn(u))},s);return(u&&typeof u.then=="function"?A.resolve(u).then(function(h){return a.active?h:q(new O.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):l.then(function(){return u})).then(function(h){return r&&a._resolve(),a._completion.then(function(){return h})}).catch(function(h){return a._reject(h),q(h)})})}function yt(t,e,n){for(var r=$(t)?t.slice():[t],i=0;i<n;++i)r.push(e);return r}function va(t){return T(T({},t),{table:function(e){var n=t.table(e),r=n.schema,i={},o=[];function a(m,g,w){var y=Je(m),p=i[y]=i[y]||[],_=m==null?0:typeof m=="string"?1:m.length,b=g>0,k=T(T({},w),{isVirtual:b,keyTail:g,keyLength:_,extractKey:gn(m),unique:!b&&w.unique});if(p.push(k),k.isPrimaryKey||o.push(k),_>1){var S=_===2?m[0]:m.slice(0,_-1);a(S,g+1,w)}return p.sort(function(x,E){return x.keyTail-E.keyTail}),k}var s=a(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[s];for(var c=0,u=r.indexes;c<u.length;c++){var l=u[c];a(l.keyPath,0,l)}function h(m){var g=i[Je(m)];return g&&g[0]}function f(m,g){return{type:m.type===1?2:m.type,lower:yt(m.lower,m.lowerOpen?t.MAX_KEY:t.MIN_KEY,g),lowerOpen:!0,upper:yt(m.upper,m.upperOpen?t.MIN_KEY:t.MAX_KEY,g),upperOpen:!0}}function v(m){var g=m.query.index;return g.isVirtual?T(T({},m),{query:{index:g,range:f(m.query.range,g.keyTail)}}):m}var d=T(T({},n),{schema:T(T({},r),{primaryKey:s,indexes:o,getIndexByKeyPath:h}),count:function(m){return n.count(v(m))},query:function(m){return n.query(v(m))},openCursor:function(m){var g=m.query.index,w=g.keyTail,y=g.isVirtual,p=g.keyLength;if(!y)return n.openCursor(m);function _(b){function k(x){x!=null?b.continue(yt(x,m.reverse?t.MAX_KEY:t.MIN_KEY,w)):m.unique?b.continue(b.key.slice(0,p).concat(m.reverse?t.MIN_KEY:t.MAX_KEY,w)):b.continue()}var S=Object.create(b,{continue:{value:k},continuePrimaryKey:{value:function(x,E){b.continuePrimaryKey(yt(x,t.MAX_KEY,w),E)}},primaryKey:{get:function(){return b.primaryKey}},key:{get:function(){var x=b.key;return p===1?x[0]:x.slice(0,p)}},value:{get:function(){return b.value}}});return S}return n.openCursor(v(m)).then(function(b){return b&&_(b)})}});return d}})}var ya={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:va};function Qn(t,e,n,r){return n=n||{},r=r||"",U(t).forEach(function(i){if(!X(e,i))n[r+i]=void 0;else{var o=t[i],a=e[i];if(typeof o=="object"&&typeof a=="object"&&o&&a){var s=rn(o),c=rn(a);s!==c?n[r+i]=e[i]:s==="Object"?Qn(o,a,n,r+i+"."):o!==a&&(n[r+i]=e[i])}else o!==a&&(n[r+i]=e[i])}}),U(e).forEach(function(i){X(t,i)||(n[r+i]=e[i])}),n}function ga(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var ba={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return T(T({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey,i=T(T({},n),{mutate:function(o){var a=B.trans,s=a.table(e).hook,c=s.deleting,u=s.creating,l=s.updating;switch(o.type){case"add":if(u.fire===F)break;return a._promise("readwrite",function(){return h(o)},!0);case"put":if(u.fire===F&&l.fire===F)break;return a._promise("readwrite",function(){return h(o)},!0);case"delete":if(c.fire===F)break;return a._promise("readwrite",function(){return h(o)},!0);case"deleteRange":if(c.fire===F)break;return a._promise("readwrite",function(){return f(o)},!0)}return n.mutate(o);function h(d){var m=B.trans,g=d.keys||ga(r,d);if(!g)throw new Error("Keys missing");return d=d.type==="add"||d.type==="put"?T(T({},d),{keys:g}):T({},d),d.type!=="delete"&&(d.values=tn([],d.values,!0)),d.keys&&(d.keys=tn([],d.keys,!0)),_a(n,d,g).then(function(w){var y=g.map(function(p,_){var b=w[_],k={onerror:null,onsuccess:null};if(d.type==="delete")c.fire.call(k,p,b,m);else if(d.type==="add"||b===void 0){var S=u.fire.call(k,p,d.values[_],m);p==null&&S!=null&&(p=S,d.keys[_]=p,r.outbound||ne(d.values[_],r.keyPath,p))}else{var x=Qn(b,d.values[_]),E=l.fire.call(k,x,p,b,m);if(E){var I=d.values[_];Object.keys(E).forEach(function(D){X(I,D)?I[D]=E[D]:ne(I,D,E[D])})}}return k});return n.mutate(d).then(function(p){for(var _=p.failures,b=p.results,k=p.numFailures,S=p.lastResult,x=0;x<g.length;++x){var E=b?b[x]:g[x],I=y[x];E==null?I.onerror&&I.onerror(_[x]):I.onsuccess&&I.onsuccess(d.type==="put"&&w[x]?d.values[x]:E)}return{failures:_,results:b,numFailures:k,lastResult:S}}).catch(function(p){return y.forEach(function(_){return _.onerror&&_.onerror(p)}),Promise.reject(p)})})}function f(d){return v(d.trans,d.range,1e4)}function v(d,m,g){return n.query({trans:d,values:!1,query:{index:r,range:m},limit:g}).then(function(w){var y=w.result;return h({type:"delete",keys:y,trans:d}).then(function(p){return p.numFailures>0?Promise.reject(p.failures[0]):y.length<g?{failures:[],numFailures:0,lastResult:void 0}:v(d,T(T({},m),{lower:y[y.length-1],lowerOpen:!0}),g)})})}}});return i}})}};function _a(t,e,n){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}function ii(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],i=0,o=0;i<e.keys.length&&o<t.length;++i)W(e.keys[i],t[o])===0&&(r.push(n?at(e.values[i]):e.values[i]),++o);return r.length===t.length?r:null}catch{return null}}var wa={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return T(T({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=ii(r.keys,r.trans._cache,r.cache==="clone");return i?A.resolve(i):n.getMany(r).then(function(o){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?at(o):o},o})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},Jt;function Wn(t){return!("from"in t)}var ue=function(t,e){if(this)G(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{var n=new ue;return t&&"d"in t&&G(n,t),n}};Fe(ue.prototype,(Jt={add:function(t){return Mt(this,t),this},addKey:function(t){return ot(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return ot(e,n,n)}),this}},Jt[on]=function(){return En(this)},Jt));function ot(t,e,n){var r=W(e,n);if(!isNaN(r)){if(r>0)throw RangeError();if(Wn(t))return G(t,{from:e,to:n,d:1});var i=t.l,o=t.r;if(W(n,t.from)<0)return i?ot(i,e,n):t.l={from:e,to:n,d:1,l:null,r:null},gr(t);if(W(e,t.to)>0)return o?ot(o,e,n):t.r={from:e,to:n,d:1,l:null,r:null},gr(t);W(e,t.from)<0&&(t.from=e,t.l=null,t.d=o?o.d+1:1),W(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);var a=!t.r;i&&!t.l&&Mt(t,i),o&&a&&Mt(t,o)}}function Mt(t,e){function n(r,i){var o=i.from,a=i.to,s=i.l,c=i.r;ot(r,o,a),s&&n(r,s),c&&n(r,c)}Wn(e)||n(t,e)}function ka(t,e){var n=En(e),r=n.next();if(r.done)return!1;for(var i=r.value,o=En(t),a=o.next(i.from),s=a.value;!r.done&&!a.done;){if(W(s.from,i.to)<=0&&W(s.to,i.from)>=0)return!0;W(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(a=o.next(i.from)).value}return!1}function En(t){var e=Wn(t)?null:{s:0,n:t};return{next:function(n){for(var r=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&W(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||W(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function gr(t){var e,n,r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var o=i==="r"?"l":"r",a=T({},t),s=t[i];t.from=s.from,t.to=s.to,t[i]=s[i],a[i]=s[o],t[o]=a,a.d=br(a)}t.d=br(t)}function br(t){var e=t.r,n=t.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}var xa={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,n=new ue(t.MIN_KEY,t.MAX_KEY);return T(T({},t),{table:function(r){var i=t.table(r),o=i.schema,a=o.primaryKey,s=a.extractKey,c=a.outbound,u=T(T({},i),{mutate:function(f){var v=f.trans,d=v.mutatedParts||(v.mutatedParts={}),m=function(S){var x="idb://"+e+"/"+r+"/"+S;return d[x]||(d[x]=new ue)},g=m(""),w=m(":dels"),y=f.type,p=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[[],f.values]:[],_=p[0],b=p[1],k=f.trans._cache;return i.mutate(f).then(function(S){if($(_)){y!=="delete"&&(_=S.results),g.addKeys(_);var x=ii(_,k);!x&&y!=="add"&&w.addKeys(_),(x||b)&&Ea(m,o,x,b)}else if(_){var E={from:_.lower,to:_.upper};w.add(E),g.add(E)}else g.add(n),w.add(n),o.indexes.forEach(function(I){return m(I.name).add(n)});return S})}}),l=function(f){var v,d,m=f.query,g=m.index,w=m.range;return[g,new ue((v=w.lower)!==null&&v!==void 0?v:t.MIN_KEY,(d=w.upper)!==null&&d!==void 0?d:t.MAX_KEY)]},h={get:function(f){return[a,new ue(f.key)]},getMany:function(f){return[a,new ue().addKeys(f.keys)]},count:l,query:l,openCursor:l};return U(h).forEach(function(f){u[f]=function(v){var d=B.subscr;if(d){var m=function(k){var S="idb://"+e+"/"+r+"/"+k;return d[S]||(d[S]=new ue)},g=m(""),w=m(":dels"),y=h[f](v),p=y[0],_=y[1];if(m(p.name||"").add(_),!p.isPrimaryKey)if(f==="count")w.add(n);else{var b=f==="query"&&c&&v.values&&i.query(T(T({},v),{values:!1}));return i[f].apply(this,arguments).then(function(k){if(f==="query"){if(c&&v.values)return b.then(function(I){var D=I.result;return g.addKeys(D),k});var S=v.values?k.result.map(s):k.result;v.values?g.addKeys(S):w.addKeys(S)}else if(f==="openCursor"){var x=k,E=v.values;return x&&Object.create(x,{key:{get:function(){return w.addKey(x.primaryKey),x.key}},primaryKey:{get:function(){var I=x.primaryKey;return w.addKey(I),I}},value:{get:function(){return E&&g.addKey(x.primaryKey),x.value}}})}return k})}}return i[f].apply(this,arguments)}}),u}})}};function Ea(t,e,n,r){function i(o){var a=t(o.name||"");function s(u){return u!=null?o.extractKey(u):null}var c=function(u){return o.multiEntry&&$(u)?u.forEach(function(l){return a.addKey(l)}):a.addKey(u)};(n||r).forEach(function(u,l){var h=n&&s(n[l]),f=r&&s(r[l]);W(h,f)!==0&&(h!=null&&c(h),f!=null&&c(f))})}e.indexes.forEach(i)}var Gn=function(){function t(e,n){var r=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=n=T({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var o=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:F,dbReadyPromise:null,cancelOpen:F,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};a.dbReadyPromise=new A(function(s){a.dbReadyResolve=s}),a.openCanceller=new A(function(s,c){a.cancelOpen=c}),this._state=a,this.name=e,this.on=lt(this,"populate","blocked","versionchange","close",{ready:[Mn,F]}),this.on.ready.subscribe=Rr(this.on.ready.subscribe,function(s){return function(c,u){t.vip(function(){var l=r._state;if(l.openComplete)l.dbOpenError||A.resolve().then(c),u&&s(c);else if(l.onReadyBeingFired)l.onReadyBeingFired.push(c),u&&s(c);else{s(c);var h=r;u||s(function f(){h.on.ready.unsubscribe(c),h.on.ready.unsubscribe(f)})}})}}),this.Collection=Lo(this),this.Table=Ko(this),this.Transaction=Qo(this),this.Version=ca(this),this.WhereClause=Ho(this),this.on("versionchange",function(s){s.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(s){!s.newVersion||s.newVersion<s.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+s.oldVersion/10)}),this._maxKey=it(n.IDBKeyRange),this._createTransaction=function(s,c,u,l){return new r.Transaction(s,c,u,r._options.chromeTransactionDurability,l)},this._fireOnBlocked=function(s){r.on("blocked").fire(s),Ye.filter(function(c){return c.name===r.name&&c!==r&&!c._state.vcFired}).map(function(c){return c.on("versionchange").fire(s)})},this.use(ya),this.use(ba),this.use(xa),this.use(wa),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(function(s){return s(r)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new O.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new O.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,r=n.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),n.push(r),n.sort(ea),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||B.letThrough||this._vip)?e():new A(function(r,i){if(n._state.openComplete)return i(new O.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new O.DatabaseClosed);return}n.open().catch(F)}n._state.dbReadyPromise.then(r,i)}).then(e)},t.prototype.use=function(e){var n=e.stack,r=e.create,i=e.level,o=e.name;o&&this.unuse({stack:n,name:o});var a=this._middlewares[n]||(this._middlewares[n]=[]);return a.push({stack:n,create:r,level:i==null?10:i,name:o}),a.sort(function(s,c){return s.level-c.level}),this},t.prototype.unuse=function(e){var n=e.stack,r=e.name,i=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(o){return i?o.create!==i:r?o.name!==r:!1})),this},t.prototype.open=function(){return pa(this)},t.prototype._close=function(){var e=this._state,n=Ye.indexOf(this);if(n>=0&&Ye.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new A(function(r){e.dbReadyResolve=r}),e.openCanceller=new A(function(r,i){e.cancelOpen=i})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new O.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,n=arguments.length>0,r=this._state;return new A(function(i,o){var a=function(){e.close();var s=e._deps.indexedDB.deleteDatabase(e.name);s.onsuccess=V(function(){ha(e._deps,e.name),i()}),s.onerror=oe(o),s.onblocked=e._fireOnBlocked};if(n)throw new O.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return this.idbdb!==null},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return U(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=ma.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,n,r){var i=this,o=B.trans;(!o||o.db!==this||e.indexOf("!")!==-1)&&(o=null);var a=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var s,c;try{if(c=n.map(function(l){var h=l instanceof i.Table?l.name:l;if(typeof h!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return h}),e=="r"||e===$t)s=$t;else if(e=="rw"||e==Qt)s=Qt;else throw new O.InvalidArgument("Invalid transaction mode: "+e);if(o){if(o.mode===$t&&s===Qt)if(a)o=null;else throw new O.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o&&c.forEach(function(l){if(o&&o.storeNames.indexOf(l)===-1)if(a)o=null;else throw new O.SubTransaction("Table "+l+" not included in parent transaction.")}),a&&o&&!o.active&&(o=null)}}catch(l){return o?o._promise(null,function(h,f){f(l)}):q(l)}var u=ri.bind(null,this,s,c,o,r);return o?o._promise(s,u,"lock"):B.trans?ze(B.transless,function(){return i._whenReady(u)}):this._whenReady(u)},t.prototype.table=function(e){if(!X(this._allTables,e))throw new O.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),Sa=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",Ca=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,n,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:n,complete:r}:e)},t.prototype[Sa]=function(){return this},t}();function oi(t,e){return U(e).forEach(function(n){var r=t[n]||(t[n]=new ue);Mt(r,e[n])}),t}function ai(t){var e=!1,n=void 0,r=new Ca(function(i){var o=Kn(t);function a(g){o&&Ve();var w=function(){return we(t,{subscr:g,trans:null})},y=B.trans?ze(B.transless,w):w();return o&&y.then(de,de),y}var s=!1,c={},u={},l={get closed(){return s},unsubscribe:function(){s=!0,xe.storagemutated.unsubscribe(d)}};i.start&&i.start(l);var h=!1,f=!1;function v(){return U(u).some(function(g){return c[g]&&ka(c[g],u[g])})}var d=function(g){oi(c,g),v()&&m()},m=function(){if(!(h||s)){c={};var g={},w=a(g);f||(xe(rt,d),f=!0),h=!0,Promise.resolve(w).then(function(y){e=!0,n=y,h=!1,!s&&(v()?m():(c={},u=g,i.next&&i.next(y)))},function(y){h=!1,e=!1,i.error&&i.error(y),l.unsubscribe()})}};return m(),l});return r.hasValue=function(){return e},r.getValue=function(){return n},r}var Sn;try{Sn={indexedDB:N.indexedDB||N.mozIndexedDB||N.webkitIndexedDB||N.msIndexedDB,IDBKeyRange:N.IDBKeyRange||N.webkitIDBKeyRange}}catch{Sn={indexedDB:null,IDBKeyRange:null}}var Se=Gn;Fe(Se,T(T({},Vt),{delete:function(t){var e=new Se(t,{addons:[]});return e.delete()},exists:function(t){return new Se(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return la(Se.dependencies).then(t)}catch{return q(new O.MissingAPI)}},defineClass:function(){function t(e){G(this,e)}return t},ignoreTransaction:function(t){return B.trans?ze(B.transless,t):t()},vip:kn,async:function(t){return function(){try{var e=xn(t.apply(this,arguments));return!e||typeof e.then!="function"?A.resolve(e):e}catch(n){return q(n)}}},spawn:function(t,e,n){try{var r=xn(t.apply(n,e||[]));return!r||typeof r.then!="function"?A.resolve(r):r}catch(i){return q(i)}},currentTransaction:{get:function(){return B.trans||null}},waitFor:function(t,e){var n=A.resolve(typeof t=="function"?Se.ignoreTransaction(t):t).timeout(e||6e4);return B.trans?B.trans.waitFor(n):n},Promise:A,debug:{get:function(){return ae},set:function(t){jr(t,t==="dexie"?function(){return!0}:Yr)}},derive:Le,extend:G,props:Fe,override:Rr,Events:lt,on:xe,liveQuery:ai,extendObservabilitySet:oi,getByKeyPath:fe,setByKeyPath:ne,delByKeyPath:io,shallowClone:Pr,deepClone:at,getObjectDiff:Qn,cmp:W,asap:Or,minKey:vn,addons:[],connections:Ye,errnames:jn,dependencies:Sn,semVer:hr,version:hr.split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,n*2)})}));Se.maxKey=it(Se.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(xe(rt,function(t){if(!le){var e;zt?(e=document.createEvent("CustomEvent"),e.initCustomEvent(_e,!0,!0,t)):e=new CustomEvent(_e,{detail:t}),le=!0,dispatchEvent(e),le=!1}}),addEventListener(_e,function(t){var e=t.detail;le||Ft(e)}));function Ft(t){var e=le;try{le=!0,xe.storagemutated.fire(t)}finally{le=e}}var le=!1;if(typeof BroadcastChannel!="undefined"){var gt=new BroadcastChannel(_e);typeof gt.unref=="function"&&gt.unref(),xe(rt,function(t){le||gt.postMessage(t)}),gt.onmessage=function(t){t.data&&Ft(t.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){xe(rt,function(t){try{le||(typeof localStorage!="undefined"&&localStorage.setItem(_e,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&tn([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:_e,changedParts:t})}))}catch{}}),typeof addEventListener!="undefined"&&addEventListener("storage",function(t){if(t.key===_e){var e=JSON.parse(t.newValue);e&&Ft(e.changedParts)}});var _r=self.document&&navigator.serviceWorker;_r&&_r.addEventListener("message",Aa)}function Aa(t){var e=t.data;e&&e.type===_e&&Ft(e.changedParts)}A.rejectionMapper=po;jr(ae,Yr);class Ia extends Gn{constructor(e){super(e.name);const n=this,r=C.isString(e.version)?parseInt(e.version.replaceAll(".","")):e.version;this.schema=this.version(r).stores({_app:"id",nodes:"id, __typename",links:"id, __typename, sourceId, targetId, [__typename+sourceId]"}),ai(async()=>await n._app.get(e.id)).subscribe({next:o=>{n.app=o},error:o=>{console.error(o)}}),this._init(e)}async _init(e){let n=await this._app.get(e.id);return n||(n=await this._app.add({...e,repo:{location:null}})),n}}function Ba(t={}){const{app:e}=t;let{id:n,name:r="obiwan-db",version:i="1.0.0"}=e.config.globalProperties.$app||{};return n||(n=C.hash(r)),new Ia({id:n,name:r,version:i})}var Ra=Lt({name:"QCardActions",props:{...bi,vertical:Boolean},setup(t,{slots:e}){const n=_i(t),r=z(()=>`q-card__actions ${n.value} q-card__actions--${t.vertical===!0?"vert column":"horiz row"}`);return()=>M("div",{class:r.value},Sr(e.default))}});const Oa=M("svg",{key:"svg",class:"q-radio__bg absolute non-selectable",viewBox:"0 0 24 24"},[M("path",{d:"M12,22a10,10 0 0 1 -10,-10a10,10 0 0 1 10,-10a10,10 0 0 1 10,10a10,10 0 0 1 -10,10m0,-22a12,12 0 0 0 -12,12a12,12 0 0 0 12,12a12,12 0 0 0 12,-12a12,12 0 0 0 -12,-12"}),M("path",{class:"q-radio__check",d:"M12,6a6,6 0 0 0 -6,6a6,6 0 0 0 6,6a6,6 0 0 0 6,-6a6,6 0 0 0 -6,-6"})]);var Da=Lt({name:"QRadio",props:{...In,...wi,...ki,modelValue:{required:!0},val:{required:!0},label:String,leftLabel:Boolean,checkedIcon:String,uncheckedIcon:String,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},emits:["update:modelValue"],setup(t,{slots:e,emit:n}){const{proxy:r}=Rn(),i=Bn(t,r.$q),o=xi(t,Fi),a=Xe(null),{refocusTargetEl:s,refocusTarget:c}=Li(t,a),u=z(()=>Bt(t.modelValue)===Bt(t.val)),l=z(()=>"q-radio cursor-pointer no-outline row inline no-wrap items-center"+(t.disable===!0?" disabled":"")+(i.value===!0?" q-radio--dark":"")+(t.dense===!0?" q-radio--dense":"")+(t.leftLabel===!0?" reverse":"")),h=z(()=>{const p=t.color!==void 0&&(t.keepColor===!0||u.value===!0)?` text-${t.color}`:"";return`q-radio__inner relative-position q-radio__inner--${u.value===!0?"truthy":"falsy"}${p}`}),f=z(()=>(u.value===!0?t.checkedIcon:t.uncheckedIcon)||null),v=z(()=>t.disable===!0?-1:t.tabindex||0),d=z(()=>{const p={type:"radio"};return t.name!==void 0&&Object.assign(p,{".checked":u.value===!0,"^checked":u.value===!0?"checked":void 0,name:t.name,value:t.val}),p}),m=Ci(d);function g(p){p!==void 0&&(Yn(p),c(p)),t.disable!==!0&&u.value!==!0&&n("update:modelValue",t.val,p)}function w(p){(p.keyCode===13||p.keyCode===32)&&Yn(p)}function y(p){(p.keyCode===13||p.keyCode===32)&&g(p)}return Object.assign(r,{set:g}),()=>{const p=f.value!==null?[M("div",{key:"icon",class:"q-radio__icon-container absolute-full flex flex-center no-wrap"},[M(Ei,{class:"q-radio__icon",name:f.value})])]:[Oa];t.disable!==!0&&m(p,"unshift"," q-radio__native q-ma-none q-pa-none");const _=[M("div",{class:h.value,style:o.value,"aria-hidden":"true"},p)];s.value!==null&&_.push(s.value);const b=t.label!==void 0?Si(e.default,[t.label]):Sr(e.default);return b!==void 0&&_.push(M("div",{class:"q-radio__label q-anchor--skip"},b)),M("div",{ref:a,class:l.value,tabindex:v.value,role:"radio","aria-label":t.label,"aria-checked":u.value===!0?"true":"false","aria-disabled":t.disable===!0?"true":void 0,onClick:g,onKeydown:w,onKeyup:y},_)}}});const si={radio:Da,checkbox:Ni,toggle:Vi},Pa=Object.keys(si);var Ka=Lt({name:"QOptionGroup",props:{...In,modelValue:{required:!0},options:{type:Array,validator:t=>t.every(e=>"value"in e&&"label"in e)},name:String,type:{default:"radio",validator:t=>Pa.includes(t)},color:String,keepColor:Boolean,dense:Boolean,size:String,leftLabel:Boolean,inline:Boolean,disable:Boolean},emits:["update:modelValue"],setup(t,{emit:e,slots:n}){const{proxy:{$q:r}}=Rn(),i=Array.isArray(t.modelValue);t.type==="radio"?i===!0&&console.error("q-option-group: model should not be array"):i===!1&&console.error("q-option-group: model should be array in your case");const o=Bn(t,r),a=z(()=>si[t.type]),s=z(()=>"q-option-group q-gutter-x-sm"+(t.inline===!0?" q-option-group--inline":"")),c=z(()=>{const l={role:"group"};return t.type==="radio"&&(l.role="radiogroup",t.disable===!0&&(l["aria-disabled"]="true")),l});function u(l){e("update:modelValue",l)}return()=>M("div",{class:s.value,...c.value},t.options.map((l,h)=>{const f=n["label-"+h]!==void 0?()=>n["label-"+h](l):n.label!==void 0?()=>n.label(l):void 0;return M("div",[M(a.value,{modelValue:t.modelValue,val:l.value,name:l.name===void 0?t.name:l.name,disable:t.disable||l.disable,label:f===void 0?l.label:null,leftLabel:l.leftLabel===void 0?t.leftLabel:l.leftLabel,color:l.color===void 0?t.color:l.color,checkedIcon:l.checkedIcon,uncheckedIcon:l.uncheckedIcon,dark:l.dark||o.value,size:l.size===void 0?t.size:l.size,dense:t.dense,keepColor:l.keepColor===void 0?t.keepColor:l.keepColor,"onUpdate:modelValue":u},f)])}))}}),Ta=Lt({name:"DialogPlugin",props:{...In,title:String,message:String,prompt:Object,options:Object,progress:[Boolean,Object],html:Boolean,ok:{type:[String,Object,Boolean],default:!0},cancel:[String,Object,Boolean],focus:{type:String,default:"ok",validator:t=>["ok","cancel","none"].includes(t)},stackButtons:Boolean,color:String,cardClass:[String,Array,Object],cardStyle:[String,Array,Object]},emits:["ok","hide"],setup(t,{emit:e}){const{proxy:n}=Rn(),{$q:r}=n,i=Bn(t,r),o=Xe(null),a=Xe(t.prompt!==void 0?t.prompt.model:t.options!==void 0?t.options.model:void 0),s=z(()=>"q-dialog-plugin"+(i.value===!0?" q-dialog-plugin--dark q-dark":"")+(t.progress!==!1?" q-dialog-plugin--progress":"")),c=z(()=>t.color||(i.value===!0?"amber":"primary")),u=z(()=>t.progress===!1?null:qe(t.progress)===!0?{component:t.progress.spinner||Jn,props:{color:t.progress.color||c.value}}:{component:Jn,props:{color:c.value}}),l=z(()=>t.prompt!==void 0||t.options!==void 0),h=z(()=>{if(l.value!==!0)return{};const{model:P,isValid:R,items:L,...Y}=t.prompt!==void 0?t.prompt:t.options;return Y}),f=z(()=>qe(t.ok)===!0||t.ok===!0?r.lang.label.ok:t.ok),v=z(()=>qe(t.cancel)===!0||t.cancel===!0?r.lang.label.cancel:t.cancel),d=z(()=>t.prompt!==void 0?t.prompt.isValid!==void 0&&t.prompt.isValid(a.value)!==!0:t.options!==void 0?t.options.isValid!==void 0&&t.options.isValid(a.value)!==!0:!1),m=z(()=>({color:c.value,label:f.value,ripple:!1,disable:d.value,...qe(t.ok)===!0?t.ok:{flat:!0},"data-autofocus":t.focus==="ok"&&l.value!==!0||void 0,onClick:p})),g=z(()=>({color:c.value,label:v.value,ripple:!1,...qe(t.cancel)===!0?t.cancel:{flat:!0},"data-autofocus":t.focus==="cancel"&&l.value!==!0||void 0,onClick:_}));At(()=>t.prompt&&t.prompt.model,k),At(()=>t.options&&t.options.model,k);function w(){o.value.show()}function y(){o.value.hide()}function p(){e("ok",Bt(a.value)),y()}function _(){y()}function b(){e("hide")}function k(P){a.value=P}function S(P){d.value!==!0&&t.prompt.type!=="textarea"&&Bi(P,13)===!0&&p()}function x(P,R){return t.html===!0?M(He,{class:P,innerHTML:R}):M(He,{class:P},()=>R)}function E(){return[M(Ii,{color:c.value,dense:!0,autofocus:!0,dark:i.value,...h.value,modelValue:a.value,"onUpdate:modelValue":k,onKeyup:S})]}function I(){return[M(Ka,{color:c.value,options:t.options.items,dark:i.value,...h.value,modelValue:a.value,"onUpdate:modelValue":k})]}function D(){const P=[];return t.cancel&&P.push(M(Zn,g.value)),t.ok&&P.push(M(Zn,m.value)),M(Ra,{class:t.stackButtons===!0?"items-end":"",vertical:t.stackButtons,align:"right"},()=>P)}function K(){const P=[];return t.title&&P.push(x("q-dialog__title",t.title)),t.progress!==!1&&P.push(M(He,{class:"q-dialog__progress"},()=>M(u.value.component,u.value.props))),t.message&&P.push(x("q-dialog__message",t.message)),t.prompt!==void 0?P.push(M(He,{class:"scroll q-dialog-plugin__form"},E)):t.options!==void 0&&P.push(M(Xn,{dark:i.value}),M(He,{class:"scroll q-dialog-plugin__form"},I),M(Xn,{dark:i.value})),(t.ok||t.cancel)&&P.push(D()),P}function j(){return[M(Ai,{class:[s.value,t.cardClass],style:t.cardStyle,dark:i.value},K)]}return Object.assign(n,{show:w,hide:y}),()=>M(zi,{ref:o,onHide:b},j)}});const Xt=["sm","md","lg","xl"],{passive:wr}=Pi;On({width:0,height:0,name:"xs",sizes:{sm:600,md:1024,lg:1440,xl:1920},lt:{sm:!0,md:!0,lg:!0,xl:!0},gt:{xs:!1,sm:!1,md:!1,lg:!1},xs:!0,sm:!1,md:!1,lg:!1,xl:!1},{setSizes:er,setDebounce:er,install({$q:t,onSSRHydrated:e}){if(t.screen=this,this.__installed===!0){t.config.screen!==void 0&&(t.config.screen.bodyClasses===!1?document.body.classList.remove(`screen--${this.name}`):this.__update(!0));return}const{visualViewport:n}=window,r=n||window,i=document.scrollingElement||document.documentElement,o=n===void 0||Ri.is.mobile===!0?()=>[Math.max(window.innerWidth,i.clientWidth),Math.max(window.innerHeight,i.clientHeight)]:()=>[n.width*n.scale+window.innerWidth-i.clientWidth,n.height*n.scale+window.innerHeight-i.clientHeight],a=t.config.screen!==void 0&&t.config.screen.bodyClasses===!0;this.__update=h=>{const[f,v]=o();if(v!==this.height&&(this.height=v),f!==this.width)this.width=f;else if(h!==!0)return;let d=this.sizes;this.gt.xs=f>=d.sm,this.gt.sm=f>=d.md,this.gt.md=f>=d.lg,this.gt.lg=f>=d.xl,this.lt.sm=f<d.sm,this.lt.md=f<d.md,this.lt.lg=f<d.lg,this.lt.xl=f<d.xl,this.xs=this.lt.sm,this.sm=this.gt.xs===!0&&this.lt.md===!0,this.md=this.gt.sm===!0&&this.lt.lg===!0,this.lg=this.gt.md===!0&&this.lt.xl===!0,this.xl=this.gt.lg,d=this.xs===!0&&"xs"||this.sm===!0&&"sm"||this.md===!0&&"md"||this.lg===!0&&"lg"||"xl",d!==this.name&&(a===!0&&(document.body.classList.remove(`screen--${this.name}`),document.body.classList.add(`screen--${d}`)),this.name=d)};let s,c={},u=16;this.setSizes=h=>{Xt.forEach(f=>{h[f]!==void 0&&(c[f]=h[f])})},this.setDebounce=h=>{u=h};const l=()=>{const h=getComputedStyle(document.body);h.getPropertyValue("--q-size-sm")&&Xt.forEach(f=>{this.sizes[f]=parseInt(h.getPropertyValue(`--q-size-${f}`),10)}),this.setSizes=f=>{Xt.forEach(v=>{f[v]&&(this.sizes[v]=f[v])}),this.__update(!0)},this.setDebounce=f=>{s!==void 0&&r.removeEventListener("resize",s,wr),s=f>0?Di(this.__update,f):this.__update,r.addEventListener("resize",s,wr)},this.setDebounce(u),Object.keys(c).length!==0?(this.setSizes(c),c=void 0):this.__update(),a===!0&&this.name==="xs"&&document.body.classList.add("screen--xs")};Oi.value===!0?e.push(l):l()}});const Q=On({isActive:!1,mode:!1},{__media:void 0,set(t){Q.mode=t,t==="auto"?(Q.__media===void 0&&(Q.__media=window.matchMedia("(prefers-color-scheme: dark)"),Q.__updateMedia=()=>{Q.set("auto")},Q.__media.addListener(Q.__updateMedia)),t=Q.__media.matches):Q.__media!==void 0&&(Q.__media.removeListener(Q.__updateMedia),Q.__media=void 0),Q.isActive=t===!0,document.body.classList.remove(`body--${t===!0?"light":"dark"}`),document.body.classList.add(`body--${t===!0?"dark":"light"}`)},toggle(){Q.set(Q.isActive===!1)},install({$q:t,ssrContext:e}){const{dark:n}=t.config;t.dark=this,this.__installed!==!0&&this.set(n!==void 0?n:!1)}});var ja={name:"material-icons",type:{positive:"check_circle",negative:"warning",info:"info",warning:"priority_high"},arrow:{up:"arrow_upward",right:"arrow_forward",down:"arrow_downward",left:"arrow_back",dropdown:"arrow_drop_down"},chevron:{left:"chevron_left",right:"chevron_right"},colorPicker:{spectrum:"gradient",tune:"tune",palette:"style"},pullToRefresh:{icon:"refresh"},carousel:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down",navigationIcon:"lens"},chip:{remove:"cancel",selected:"check"},datetime:{arrowLeft:"chevron_left",arrowRight:"chevron_right",now:"access_time",today:"today"},editor:{bold:"format_bold",italic:"format_italic",strikethrough:"strikethrough_s",underline:"format_underlined",unorderedList:"format_list_bulleted",orderedList:"format_list_numbered",subscript:"vertical_align_bottom",superscript:"vertical_align_top",hyperlink:"link",toggleFullscreen:"fullscreen",quote:"format_quote",left:"format_align_left",center:"format_align_center",right:"format_align_right",justify:"format_align_justify",print:"print",outdent:"format_indent_decrease",indent:"format_indent_increase",removeFormat:"format_clear",formatting:"text_format",fontSize:"format_size",align:"format_align_left",hr:"remove",undo:"undo",redo:"redo",heading:"format_size",code:"code",size:"format_size",font:"font_download",viewSource:"code"},expansionItem:{icon:"keyboard_arrow_down",denseIcon:"arrow_drop_down"},fab:{icon:"add",activeIcon:"close"},field:{clear:"cancel",error:"error"},pagination:{first:"first_page",prev:"keyboard_arrow_left",next:"keyboard_arrow_right",last:"last_page"},rating:{icon:"grade"},stepper:{done:"check",active:"edit",error:"warning"},tabs:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down"},table:{arrowUp:"arrow_upward",warning:"warning",firstPage:"first_page",prevPage:"chevron_left",nextPage:"chevron_right",lastPage:"last_page"},tree:{icon:"play_arrow"},uploader:{done:"done",clear:"clear",add:"add_box",upload:"cloud_upload",removeQueue:"clear_all",removeUploaded:"done_all"}};const kr=On({iconMapFn:null,__icons:{}},{set(t,e){const n={...t,rtl:t.rtl===!0};n.set=kr.set,Object.assign(kr.__icons,n)},install({$q:t,iconSet:e,ssrContext:n}){t.config.iconMapFn!==void 0&&(this.iconMapFn=t.config.iconMapFn),t.iconSet=this.__icons,Ki(t,"iconMapFn",()=>this.iconMapFn,r=>{this.iconMapFn=r}),this.__installed===!0?e!==void 0&&this.set(e):this.set(e||ja)}});function Ma(t,e){const n=Ti(t);n.config.globalProperties=e.config.globalProperties;const{reload:r,...i}=e._context;return Object.assign(n._context,i),n}function ui(t,e){for(const n in e)n!=="spinner"&&Object(e[n])===e[n]?(t[n]=Object(t[n])!==t[n]?{}:{...t[n]},ui(t[n],e[n])):t[n]=e[n]}function Fa(t,e,n){return r=>{let i,o;const a=e===!0&&r.component!==void 0;if(a===!0){const{component:y,componentProps:p}=r;i=typeof y=="string"?n.component(y):y,o=p||{}}else{const{class:y,style:p,..._}=r;i=t,o=_,y!==void 0&&(_.cardClass=y),p!==void 0&&(_.cardStyle=p)}let s,c=!1;const u=Xe(null),l=ji(!1,"dialog"),h=y=>{if(u.value!==null&&u.value[y]!==void 0){u.value[y]();return}const p=s.$.subTree;if(p&&p.component){if(p.component.proxy&&p.component.proxy[y]){p.component.proxy[y]();return}if(p.component.subTree&&p.component.subTree.component&&p.component.subTree.component.proxy&&p.component.subTree.component.proxy[y]){p.component.subTree.component.proxy[y]();return}}console.error("[Quasar] Incorrectly defined Dialog component")},f=[],v=[],d={onOk(y){return f.push(y),d},onCancel(y){return v.push(y),d},onDismiss(y){return f.push(y),v.push(y),d},hide(){return h("hide"),d},update(y){if(s!==null){if(a===!0)Object.assign(o,y);else{const{class:p,style:_,...b}=y;p!==void 0&&(b.cardClass=p),_!==void 0&&(b.cardStyle=_),ui(o,b)}s.$forceUpdate()}return d}},m=y=>{c=!0,f.forEach(p=>{p(y)})},g=()=>{w.unmount(l),Mi(l),w=null,s=null,c!==!0&&v.forEach(y=>{y()})};let w=Ma({name:"QGlobalDialog",setup:()=>()=>M(i,{...o,ref:u,onOk:m,onHide:g,onVnodeMounted(...y){typeof o.onVnodeMounted=="function"&&o.onVnodeMounted(...y),An(()=>h("show"))}})},n);return s=w.mount(l),d}}var xr={install({$q:t,parentApp:e}){t.dialog=Fa(Ta,!0,e),this.__installed!==!0&&(this.create=t.dialog)}};const bt=new WeakMap;function La(t,e,n={context:null,ms:100}){let r=bt.get(e);r||(r=[],bt.set(e,r),An(()=>{const i=bt.get(e);e.call(n.context,i),bt.set(e,[])})),r.push(t)}function Na({actions:t,app:e,config:n={},getters:r,router:i,schema:o,state:a}={}){o&&(n.schema=o);const s=new Hi(n);return Xi("store",{state:()=>({[".ignore"]:[u=>u.$.eRoot().ns!=="ecore"],repo:s,...a}),getters:{branches(u){return u.repo.branches},createConnection(){},currentBranch(u){return u.repo.currentBranch},commits(u){return u.repo.commits},head(u){return u.repo.head},indices(u){return u.repo.indices},nodes(u){return u.repo.nodes},remotes(u){return u.repo.remotes},resources(u){return C.groupBy(u.repo.nodes,"$.eResource")},...r},actions:{add(...u){return this.repo.add.apply(this.repo,u)},addNode(...u){return this.repo.addNode.apply(this.repo,u)},checkout(...u){return this.repo.checkout.apply(this.repo,u)},commit(...u){return this.repo.commit.apply(this.repo,u)},construct(...u){return this.repo.construct.apply(this.repo,u)},createBranch(...u){return this.repo.createBranch.apply(this.repo,u)},createNode(...u){return this.repo.createNode.apply(this.repo,u)},createStoreId(...u){return this.repo.createStoreId.apply(this.repo,u)},deleteBranch(...u){return this.repo.deleteBranch.apply(this.repo,u)},async ensureLink({source:u,target:l}){debugger;return new Promise((h,f)=>{debugger;let v=!1;xr.create({title:"Alert",message:"Some message"}).onOk(()=>{h({ok:!0}),v=!0}).onCancel(()=>{f({cancel:!0}),v=!0}).onDismiss(()=>{v||f({dismiss:!0})})})},async ensureRequiredProperties(){return new Promise((u,l)=>{debugger;xr.create({title:"Alert",message:"Some message"}).onOk(()=>{u({ok:!0})}).onCancel(()=>{l({cancel:!0})}).onDismiss(()=>{l({dismiss:!0})})})},emit(...u){return this.repo.emit.apply(this.repo,u)},exportData(u,l){return Zi(u,l)},get(...u){return this.repo.get.apply(this.repo,u)},getRootClasses(...u){const l=this.repo.getRootClasses.apply(this.repo,u),h=this.getType("ecore.EPackage");return l.indexOf(h)===-1&&l.push(h),console.log("TODO: Alleen nog maar store.getRootClasses gebruiken"),l},getType(...u){return this.repo.getType.apply(this.repo,u)},findOne(...u){return this.repo.findOne.apply(this.repo,u)},filter(...u){return this.repo.filter.apply(this.repo,u)},importData(){},on(...u){return this.repo.on.apply(this.repo,u)},once(...u){return this.repo.once.apply(this.repo,u)},query(...u){return this.repo.query.apply(this.repo,u)},registerComponents(u,l){var f;if(C.isString(u)&&(u=this.getType(u)),!u||C.isEmpty(l))return;this.getType("ecore.EClass").getEStructuralFeature("components")?u.components?C.forEach(l,v=>{u.components.push(v)}):u.components=l:(f=u.extensions)!=null&&f.components?C.forEach(l,v=>{var d;(d=u.extensions)==null||d.components.push(v)}):C.set(u,"extensions.components",l)},registerPackage(...u){return this.repo.registerPackage.apply(this.repo,u)},...t}})}function Va(t={}){const e=Ba(t);t.state={changes:[],hasChanges:!1,objectsByState:{},useDexie:!1},t.getters={db(){return e}};const n=Na.call(null,t)();async function r(){debugger;const i=await e.nodes.toArray();C.forEach(i,o=>{o.__virtual||n.addNode({data:o})}),n.repo.on("created",async({node:o})=>{if(n.useDexie===!1)return;debugger;const a=o.$.decycle({containments:"asRefs"});try{const s=await e.nodes.put(a),c=!0}catch{debugger}}),n.repo.on("removed",async({node:o})=>{n.useDexie!==!1&&await e.nodes.delete(o.id)}),n.repo.on("changed",o=>{if(n.useDexie===!1)return;function a(s){const c=C.groupBy(s,"node.id");C.forIn(c,async u=>{C.forEach(u,async({node:l})=>{const h=l.$.decycle({containments:"asRefs"});try{const f=await e.nodes.put(h),v=!0}catch{debugger}})})}La(o,a)}),At(n.nodes,()=>{const o=n.repo.getChanges(),a=[];C.forEach(o.added,s=>a.push(s)),C.forEach(o.changed,s=>a.push(s)),C.forEach(o.removed,s=>a.push(s)),n.$patch(s=>{s.objectsByState=o,s.changes=a,s.hasChanges=!C.isEmpty(a)})})}return r(),n}const za={install({app:t,eventBus:e,router:n}){const r=Va({app:t,eventBus:e,router:n});return t.config.globalProperties.$store=r,t.provide("store",r),r}};var $a=({app:t,router:e})=>{const n=t.config.globalProperties.$bus,r=za.install({app:t,eventBus:n,router:e});r.useDexie=!0,Ui(r)};export{$a as default};
